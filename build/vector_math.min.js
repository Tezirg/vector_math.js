// Sun, 27 Sep 2015 22:10:05 GMT

/*
 * Copyright (c) 2015 vector_math.js
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use, copy,
 * modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&false)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.vectormath=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports={name:"vector_math.js",version:"0.0.1",author:"jean Grizet <jean.grizet@gmail.com>",keywords:["vector_math","vector_math.js","vector","simd"],main:"src/vector_math.js",devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.5","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4",browserify:"*"}}},{}],2:[function(a,b,c){function d(){this.min=e.zero(),this.max=e.zero()}b.exports=d;var e=a("./vector3.js"),f=a("./triangle.js"),g=(a("./sphere.js"),a("./quad.js"),a("./ray.js"),a("./plane.js"));d.prototype.__defineGetter__("center",function(){var a=this.min.clone();return a.add(this.max),a.scale(.5),a}),d.copy=function(a){var b=new d;return b.min.setFrom(a.min),b.max.setFrom(a.max),b},d.minMax=function(a,b){var c=new d;return c.min.setFrom(a),c.max.setFrom(b),c},d.fromSphere=function(a){var b=new d;return b.setSphere(a),b},d.fromTriangle=function(a){var b=new d;return b.setTriangle(a),b},d.fromQuad=function(a){var b=new d;return b.setQuad(a),b},d.fromRay=function(a,b,c){var e=new d;return e.setRay(a,b,c),e},d.centerAndHalfExtents=function(a,b){var c=new d;return c.setCenterAndHalfExtents(a,b),c},d.fromBuffer=function(a,b){var c=new d;return c.min=e.fromBuffer(a,b),c.max=e.fromBuffer(a,b+3*Float32Array.BYTES_PER_ELEMENT),c},d.prototype.setCenterAndHalfExtents=function(a,b){this.min.setFrom(a),this.min.sub(b),this.max.setFrom(a),this.max.add(b)},d.prototype.setSphere=function(a){this.min.splat(-a.radius),this.min.add(a.center),this.max.splat(a.radius),this.max.add(a.center)},d.prototype.setTriangle=function(a){this.min.setValues(Math.min(a.point0.x,Math.min(a.point1.x,a.point2.x)),Math.min(a.point0.y,Math.min(a.point1.y,a.point2.y)),Math.min(a.point0.z,Math.min(a.point1.z,a.point2.z))),this.max.setValues(Math.max(a.point0.x,Math.max(a.point1.x,a.point2.x)),Math.max(a.point0.y,Math.max(a.point1.y,a.point2.y)),Math.max(a.point0.z,Math.max(a.point1.z,a.point2.z)))},d.prototype.setQuad=function(a){this.min.setValues(Math.min(a.point0.x,Math.min(a.point1.x,Math.min(a.point2.x,a.point3.x))),Math.min(a.point0.y,Math.min(a.point1.y,Math.min(a.point2.y,a.point3.y))),Math.min(a.point0.z,Math.min(a.point1.z,Math.min(a.point2.z,a.point3.z)))),this.max.setValues(Math.max(a.point0.x,Math.max(a.point1.x,Math.max(a.point2.x,a.point3.x))),Math.max(a.point0.y,Math.max(a.point1.y,Math.max(a.point2.y,a.point3.y))),Math.max(a.point0.z,Math.max(a.point1.z,Math.max(a.point2.z,a.point3.z))))},d.prototype.setRay=function(a,b,c){if(a.copyAt(this.min,b),a.copyAt(this.max,c),this.max.x<this.min.x){var d=this.max.x;this.max.x=this.min.x,this.min.x=d}this.max.y<this.min.y&&(d=this.max.y,this.max.y=this.min.y,this.min.y=d),this.max.z<this.min.z&&(d=this.max.z,this.max.z=this.min.z,this.min.z=d)},d.prototype.copyCenterAndHalfExtents=function(a,b){a.setFrom(this.min),a.add(this.max),a.scale(.5),b.setFrom(this.max),b.sub(this.min),b.scale(.5)},d.prototype.copyCenter=function(a){a.setFrom(this.min),a.add(this.max),a.scale(.5)},d.prototype.copyFrom=function(a){this.min.setFrom(a.min),this.max.setFrom(a.max)},d.prototype.transform=function(a){var b=e.zero(),c=e.zero();return this.copyCenterAndHalfExtents(b,c),a.transform3(b),a.absoluteRotate(c),this.min.setFrom(b),this.min.sub(c),this.max.setFrom(b),this.max.add(c),this},d.prototype.rotate=function(a){var b=e.zero(),c=e.zero();return this.copyCenterAndHalfExtents(b,c),a.absoluteRotate(c),this.min.setFrom(b),this.min.sub(c),this.max.setFrom(b),this.max.add(c),this},d.prototype.transformed=function(a,b){b.copyFrom(this),b.transform(a)},d.prototype.rotated=function(a,b){b.copyFrom(this),b.rotate(a)},d.prototype.getPN=function(a,b,c){a.x<0?(b.x=this.min.x,c.x=this.max.x):(b.x=this.max.x,c.x=this.min.x),a.y<0?(b.y=this.min.y,c.y=this.max.y):(b.y=this.max.y,c.y=this.min.y),a.z<0?(b.z=this.min.z,c.z=this.max.z):(b.z=this.max.z,c.z=this.min.z)},d.prototype.hull=function(a){e.min(this.min,a.min,this.min),e.max(this.max,a.max,this.max)},d.prototype.hullPoint=function(a){e.min(this.min,a,this.min),e.max(this.max,a,this.max)},d.prototype.containsAabb3=function(a){var b=a.max,c=a.min;return this.min.x<c.x&&this.min.y<c.y&&this.min.z<c.z&&this.max.x>b.x&&this.max.y>b.y&&this.max.z>b.z},d.prototype.containsSphere=function(a){var b=e.all(a.radius),c=d.centerAndHalfExtents(a.center,b);return this.containsAabb3(c)},d.prototype.containsVector3=function(a){return this.min.x<a.x&&this.min.y<a.y&&this.min.z<a.z&&this.max.x>a.x&&this.max.y>a.y&&this.max.z>a.z},d.prototype.containsTriangle=function(a){return this.containsVector3(a.point0)&&this.containsVector3(a.point1)&&this.containsVector3(a.point2)},d.prototype.intersectsWithAabb3=function(a){var b=a.max,c=a.min;return this.min.x<=b.x&&this.min.y<=b.y&&this.min.z<=b.z&&this.max.x>=c.x&&this.max.y>=c.y&&this.max.z>=c.z},d.prototype.intersectsWithSphere=function(a){for(var b=a.center,c=a.radius,d=0,e=0,f=0;3>f;++f)if((e=b.storage[f]-this.min.storage[f])<0){if(-c>e)return!1;d+=e*e}else if((e=b.storage[f]-this.max.storage[f])>0){if(e>c)return!1;d+=e*e}return c*c>=d},d.prototype.intersectsWithVector3=function(a){return this.min.x<=a.x&&this.min.y<=a.y&&this.min.z<=a.z&&this.max.x>=a.x&&this.max.y>=a.y&&this.max.z>=a.z};var h=e.zero(),i=e.zero(),j=e.zero(),k=e.zero(),l=e.zero(),m=e.zero(),n=e.zero(),o=e.zero(),p=new g;d.prototype.intersectsWithTriangle=function(a){var b,c,d,e,f,g=Number.EPSILON;return this.copyCenterAndHalfExtents(h,i),j.setFrom(a.point0),j.sub(h),k.setFrom(a.point1),k.sub(h),l.setFrom(a.point2),l.sub(h),m.setFrom(k),m.sub(j),n.setFrom(l),n.sub(k),o.setFrom(j),o.sub(l),f=m.y*m.y+m.z*m.z,f>g&&(b=j.z*m.y-j.y*m.z,d=l.z*m.y-l.y*m.z,e=i.storage[1]*Math.abs(m.z)+i.storage[2]*Math.abs(m.y),Math.max(-Math.max(b,d),Math.min(b,d))>e+g)?!1:(f=n.y*n.y+n.z*n.z,f>g&&(b=j.z*n.y-j.y*n.z,c=k.z*n.y-k.y*n.z,e=i.storage[1]*Math.abs(n.z)+i.storage[2]*Math.abs(n.y),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:(f=o.y*o.y+o.z*o.z,f>g&&(b=j.z*o.y-j.y*o.z,c=k.z*o.y-k.y*o.z,e=i.storage[1]*Math.abs(o.z)+i.storage[2]*Math.abs(o.y),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:(f=m.x*m.x+m.z*m.z,f>g&&(b=j.x*m.z-j.z*m.x,d=l.x*m.z-l.z*m.x,e=i.storage[0]*Math.abs(m.z)+i.storage[2]*Math.abs(m.x),Math.max(-Math.max(b,d),Math.min(b,d))>e+g)?!1:(f=n.x*n.x+n.z*n.z,f>g&&(b=j.x*n.z-j.z*n.x,c=k.x*n.z-k.z*n.x,e=i.storage[0]*Math.abs(n.z)+i.storage[2]*Math.abs(n.x),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:(f=o.x*o.x+o.z*o.z,f>g&&(b=j.x*o.z-j.z*o.x,c=k.x*o.z-k.z*o.x,e=i.storage[0]*Math.abs(o.z)+i.storage[2]*Math.abs(o.x),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:(f=m.x*m.x+m.y*m.y,f>g&&(b=j.y*m.x-j.x*m.y,d=l.y*m.x-l.x*m.y,e=i.storage[0]*Math.abs(m.y)+i.storage[1]*Math.abs(m.x),Math.max(-Math.max(b,d),Math.min(b,d))>e+g)?!1:(f=n.x*n.x+n.y*n.y,f>g&&(b=j.y*n.x-j.x*n.y,c=k.y*n.x-k.x*n.y,e=i.storage[0]*Math.abs(n.y)+i.storage[1]*Math.abs(n.x),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:(f=o.x*o.x+o.y*o.y,f>g&&(b=j.y*o.x-j.x*o.y,c=k.y*o.x-k.x*o.y,e=i.storage[0]*Math.abs(o.y)+i.storage[1]*Math.abs(o.x),Math.max(-Math.max(b,c),Math.min(b,c))>e+g)?!1:Math.max(j.x,Math.max(k.x,l.x))<-i.storage[0]||Math.min(j.x,Math.min(k.x,l.x))>i.storage[0]?!1:Math.max(j.y,Math.max(k.y,l.y))<-i.storage[1]||Math.min(j.y,Math.min(k.y,l.y))>i.storage[1]?!1:Math.max(j.z,Math.max(k.z,l.z))<-i.storage[2]||Math.min(j.z,Math.min(k.z,l.z))>i.storage[2]?!1:(j.add(h),p.normal=m.cross(n),p.constant=p.normal.dot(j),this.intersectsWithPlane(p))))))))))},d.prototype.intersectsWithPlane=function(a){this.copyCenterAndHalfExtents(h,i);var b=i.storage[0]*Math.abs(a.normal.storage[0])+i.storage[1]*Math.abs(a.normal.storage[1])+i.storage[2]*Math.abs(a.normal.storage[2]),c=a.normal.dot(h)-a.constant;return Math.abs(c)<=b?!0:!1};var q=new f,r=new f;d.prototype.intersectsWithQuad=function(a){return a.copyTriangles(q,r),this.intersectsWithTriangle(q)||this.intersectsWithTriangle(r)}},{"./plane.js":6,"./quad.js":7,"./ray.js":9,"./sphere.js":10,"./triangle.js":11,"./vector3.js":13}],3:[function(a,b,d){function e(a,b,c,d){this.storage=new Float32Array([a,b,c,d]),this.dimension=2}b.exports=e;var f=a("./vector2.js");e.fromFloat32Array=function(a){var b=e.zero();return b.storage=a,b},e.fromBuffer=function(a,b){var c=e.zero();return c.storage=new Float32Array(a,b,4),c.clone()},e.solve=function(a,b,c){var d=a.entry(0,0),e=a.entry(0,1),f=a.entry(1,0),g=a.entry(1,1),h=c.x,i=c.y,j=d*g-e*f;0!=j&&(j=1/j),b.x=j*(g*h-e*i),b.y=j*(d*i-f*h)},e.prototype.index=function(a,b){return 2*b+a},e.prototype.entry=function(a,b){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:this.storage[this.index(a,b)]},e.prototype.setEntry=function(a,b,c){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:void(this.storage[this.index(a,b)]=c)},e.zero=function(){var a=new e(0,0,0,0);return a},e.identity=function(){var a=e.zero();return a.setIdentity(),a},e.copy=function(a){return m=e.zero(),m.setFrom(a),m},e.columns=function(a,b){var c=e.zero();return c.setColumns(a,b),c},e.outer=function(a,b){var c=e.zero();return c.setOuter(a,b),c},e.rotation=function(a){var b=e.zero();return b.setRotation(a),b},e.prototype.setValues=function(a,b,c,d){return this.storage[3]=d,this.storage[2]=c,this.storage[1]=b,this.storage[0]=a,this},e.prototype.setColumns=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=c[0],this.storage[1]=c[1],this.storage[2]=d[0],this.storage[3]=d[1],this},e.prototype.setFrom=function(a){return this.storage[3]=a.storage[3],this.storage[2]=a.storage[2],this.storage[1]=a.storage[1],this.storage[0]=a.storage[0],this},e.prototype.setOuter=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=c[0]*d[0],this.storage[1]=c[0]*d[1],this.storage[2]=c[1]*d[0],this.storage[3]=c[1]*d[1],this},e.prototype.splatDiagonal=function(a){return this.storage[0]=a,this.storage[3]=a,this},e.prototype.setDiagonal=function(a){var b=a.storage;return this.storage[0]=b[0],this.storage[3]=b[1],this},e.prototype.toString=function(){return"[0] "+this.getRow(0).toString()+"\n[1] "+this.getRow(1).toString()+"}\n"},e.prototype.getAt=function(a){return this.storage[a]},e.prototype.setAt=function(a,b){this.storage[a]=b},e.prototype.equals=function(a){return null==a.dimension||2!=a.dimension?!1:this.storage[0]==a.storage[0]&&this.storage[1]==a.storage[1]&&this.storage[2]==a.storage[2]&&this.storage[3]==a.storage[3]},e.prototype.almostEquals=function(a,b){return null==a.dimension||2!=a.dimension?!1:(void 0===b&&(b=Number.EPSILON),Math.abs(this.storage[0]-a.storage[0])>b||Math.abs(this.storage[1]-a.storage[1])>b||Math.abs(this.storage[2]-a.storage[2])>b||Math.abs(this.storage[3]-a.storage[3])>b?!1:!0)},e.prototype.__defineGetter__("row0",function(){return this.getRow(0)}),e.prototype.__defineSetter__("row0",function(a){this.setRow(0,a)}),e.prototype.__defineGetter__("row1",function(){return this.getRow(1)}),e.prototype.__defineSetter__("row1",function(a){this.setRow(1,a)}),e.prototype.setRow=function(a,b){argStorage=b.storage,this.storage[this.index(a,0)]=argStorage[0],this.storage[this.index(a,1)]=argStorage[1]},e.prototype.getRow=function(a){var b=f.zero();return rStorage=b.storage,rStorage[0]=this.storage[this.index(a,0)],rStorage[1]=this.storage[this.index(a,1)],b},e.prototype.setColumn=function(a,b){argStorage=b.storage,entry=2*a,this.storage[entry+1]=argStorage[1],this.storage[entry+0]=argStorage[0]},e.prototype.getColumn=function(a){var b=f.zero();entry=2*a;var c=b.storage;return c[1]=this.storage[entry+1],c[0]=this.storage[entry+0],b},e.prototype.clone=function(){return e.copy(this)},e.prototype.copyInto=function(a){var b=a.storage;return b[0]=this.storage[0],b[1]=this.storage[1],b[2]=this.storage[2],b[3]=this.storage[3],a},e.prototype.mult=function(a){return"Number"==typeof a?this.scaled(a):a instanceof f?this.transformed(a):2==a.dimension?this.multiplied(a):null},e.prototype.added=function(a){var b=this.clone();return b.add(a),b},e.prototype.subbed=function(a){var b=this.clone();return b.sub(a),b},e.prototype.negated=function(){var a=this.clone();return a.negate(),a},e.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this},e.prototype.setIdentity=function(){return this.storage[0]=1,this.storage[1]=0,this.storage[2]=0,this.storage[3]=1,this},e.prototype.transposed=function(){var a=this.clone();return a.transpose(),a},e.prototype.transpose=function(){var a=this.storage[2];return this.storage[2]=this.storage[1],this.storage[1]=a,this},e.prototype.absolute=function(){var a=e.zero(),b=a.storage;return b[0]=Math.abs(this.storage[0]),b[1]=Math.abs(this.storage[1]),b[2]=Math.abs(this.storage[2]),b[3]=Math.abs(this.storage[3]),a},e.prototype.determinant=function(){return this.storage[0]*this.storage[3]-this.storage[1]*this.storage[2]},e.prototype.dotRow=function(a,b){return vStorage=b.storage,this.storage[a]*vStorage[0]+this.storage[2+a]*vStorage[1]},e.prototype.dotColumn=function(a,b){return vStorage=b.storage,this.storage[2*a]*vStorage[0]+this.storage[2*a+1]*vStorage[1]},e.prototype.trace=function(){return t=0,t+=this.storage[0],t+=this.storage[3],t},e.prototype.infinityNorm=function(){return norm=0,row_norm=0,row_norm+=Math.abs(this.storage[0]),row_norm+=Math.abs(this.storage[1]),norm=row_norm>norm?row_norm:norm,row_norm=0,row_norm+=Math.abs(this.storage[2]),row_norm+=Math.abs(this.storage[3]),norm=row_norm>norm?row_norm:norm,norm},e.prototype.relativeError=function(a){return diff=a.subbed(this),correct_norm=a.infinityNorm(),diff_norm=diff.infinityNorm(),diff_norm/correct_norm},e.prototype.absoluteError=function(a){return this_norm=this.infinityNorm(),correct_norm=a.infinityNorm(),diff_norm=Math.abs(this_norm-correct_norm),diff_norm},e.prototype.invert=function(){if(det=this.determinant(),0==det)return 0;invDet=1/det;var a=this.storage[0];return this.storage[0]=this.storage[3]*invDet,this.storage[1]=-this.storage[1]*invDet,this.storage[2]=-this.storage[2]*invDet,this.storage[3]=a*invDet,det},e.prototype.copyInverse=function(a){return det=a.determinant(),0==det?(this.setFrom(a),0):(invDet=1/det,argStorage=a.storage,this.storage[0]=argStorage[3]*invDet,this.storage[1]=-argStorage[1]*invDet,this.storage[2]=-argStorage[2]*invDet,this.storage[3]=argStorage[0]*invDet,det)},e.prototype.setRotation=function(a){c=Math.cos(a),s=Math.sin(a),this.storage[0]=c,this.storage[1]=s,this.storage[2]=-s,this.storage[3]=c},e.prototype.scaleAdjoint=function(a){var b=this.storage[0];return this.storage[0]=this.storage[3]*a,this.storage[2]=-this.storage[2]*a,this.storage[1]=-this.storage[1]*a,this.storage[3]=b*a,this},e.prototype.scale=function(a){return this.storage[0]=this.storage[0]*a,this.storage[1]=this.storage[1]*a,this.storage[2]=this.storage[2]*a,this.storage[3]=this.storage[3]*a,this},e.prototype.scaled=function(a){var b=this.clone();return b.scale(a),b},e.prototype.add=function(a){return oStorage=a.storage,this.storage[0]=this.storage[0]+oStorage[0],this.storage[1]=this.storage[1]+oStorage[1],this.storage[2]=this.storage[2]+oStorage[2],this.storage[3]=this.storage[3]+oStorage[3],this},e.prototype.sub=function(a){return oStorage=a.storage,this.storage[0]=this.storage[0]-oStorage[0],this.storage[1]=this.storage[1]-oStorage[1],this.storage[2]=this.storage[2]-oStorage[2],this.storage[3]=this.storage[3]-oStorage[3],this},e.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this.storage[2]=-this.storage[2],this.storage[3]=-this.storage[3],this},e.prototype.multiply=function(a){return m00=this.storage[0],m01=this.storage[2],m10=this.storage[1],m11=this.storage[3],argStorage=a.storage,n00=argStorage[0],n01=argStorage[2],n10=argStorage[1],n11=argStorage[3],this.storage[0]=m00*n00+m01*n10,this.storage[2]=m00*n01+m01*n11,this.storage[1]=m10*n00+m11*n10,this.storage[3]=m10*n01+m11*n11,this},e.prototype.multiplied=function(a){var b=this.clone();return b.multiply(a),b},e.prototype.transposeMultiply=function(a){return m00=this.storage[0],m01=this.storage[1],m10=this.storage[2],m11=this.storage[3],argStorage=a.storage,this.storage[0]=m00*argStorage[0]+m01*argStorage[1],this.storage[2]=m00*argStorage[2]+m01*argStorage[3],this.storage[1]=m10*argStorage[0]+m11*argStorage[1],this.storage[3]=m10*argStorage[2]+m11*argStorage[3],this},e.prototype.multiplyTranspose=function(a){return m00=this.storage[0],m01=this.storage[2],m10=this.storage[1],m11=this.storage[3],argStorage=a.storage,this.storage[0]=m00*argStorage[0]+m01*argStorage[2],this.storage[2]=m00*argStorage[1]+m01*argStorage[3],this.storage[1]=m10*argStorage[0]+m11*argStorage[2],this.storage[3]=m10*argStorage[1]+m11*argStorage[3],this},e.prototype.transform=function(a){argStorage=a.storage;var b=this.storage[0]*argStorage[0]+this.storage[2]*argStorage[1],c=this.storage[1]*argStorage[0]+this.storage[3]*argStorage[1];return argStorage[0]=b,argStorage[1]=c,a},e.prototype.transformed=function(a){var b=f.copy(a);return this.transform(b)},e.prototype.copyIntoArray=function(a,b){var c=b;void 0===b&&(c=0),a[c+3]=this.storage[3],a[c+2]=this.storage[2],a[c+1]=this.storage[1],a[c+0]=this.storage[0]},e.prototype.copyFromArray=function(a,b){var c=b;void 0===b&&(c=0),this.storage[3]=a[c+3],this.storage[2]=a[c+2],this.storage[1]=a[c+1],this.storage[0]=a[c+0]}},{"./vector2.js":12}],4:[function(a,b,c){function d(a,b,c,d,e,f,g,h,i){this.storage=new Float32Array([a,b,c,d,e,f,g,h,i]),this.dimension=3}b.exports=d;var e=(a("./vector2.js"),a("./vector3.js"));a("./matrix2.js"),a("./quaternion.js");d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,9),c.clone()},d.solve2=function(a,b,c){var d=a.entry(0,0),e=a.entry(0,1),f=a.entry(1,0),g=a.entry(1,1),h=c.x-a.storage[6],i=c.y-a.storage[7],j=d*g-e*f;0!=j&&(j=1/j),b.x=j*(g*h-e*i),b.y=j*(d*i-f*h)},d.solve=function(a,b,c){var d,e,f,g,h=a.entry(0,0),i=a.entry(1,0),j=a.entry(2,0),k=a.entry(0,1),l=a.entry(1,1),m=a.entry(2,1),n=a.entry(0,2),o=a.entry(1,2),p=a.entry(2,2);d=l*p-m*o,e=m*n-k*p,f=k*o-l*n,g=h*d+i*e+j*f,0!=g&&(g=1/g);var q=g*(c.x*d+c.y*e+c.z*f);d=-(o*c.z-p*c.y),e=-(p*c.x-n*c.z),f=-(n*c.y-o*c.x);var r=g*(h*d+i*e+j*f);d=-(c.y*m-c.z*l),e=-(c.z*k-c.x*m),f=-(c.x*l-c.y*k);var s=g*(h*d+i*e+j*f);b.x=q,b.y=r,b.z=s},d.prototype.index=function(a,b){return 3*b+a},d.prototype.entry=function(a,b){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:this.storage[this.index(a,b)]},d.prototype.setEntry=function(a,b,c){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:void(this.storage[this.index(a,b)]=c)},d.zero=function(){var a=new d(0,0,0,0,0,0,0,0,0);return a},d.identity=function(){var a=d.zero();return a.setIdentity(),a},d.copy=function(a){var b=d.zero();return b.setFrom(a),b},d.columns=function(a,b,c){var e=d.zero();return e.setColumns(a,b,c),e},d.outer=function(a,b){var c=d.zero();return c.setOuter(a,b),c},d.rotation=function(a){var b=d.zero();return b.setRotation(a),b},d.rotationX=function(a){var b=d.zero();return b.setRotationX(a),b},d.rotationY=function(a){var b=d.zero();return b.setRotationY(a),b},d.rotationZ=function(a){var b=d.zero();return b.setRotationZ(a),b},d.prototype.setValues=function(a,b,c,d,e,f,g,h,i){return this.storage[8]=i,this.storage[7]=h,this.storage[6]=g,this.storage[5]=f,this.storage[4]=e,this.storage[3]=d,this.storage[2]=c,this.storage[1]=b,this.storage[0]=a,this},d.prototype.setColumns=function(a,b,c){var d=a.storage,e=b.storage,f=c.storage;return this.storage[0]=d[0],this.storage[1]=d[1],this.storage[2]=d[2],this.storage[3]=e[0],this.storage[4]=e[1],this.storage[5]=e[2],this.storage[6]=f[0],this.storage[7]=f[1],this.storage[8]=f[2],this},d.prototype.setFrom=function(a){var b=a.storage;return this.storage[8]=b[8],this.storage[7]=b[7],this.storage[6]=b[6],this.storage[5]=b[5],this.storage[4]=b[4],this.storage[3]=b[3],this.storage[2]=b[2],this.storage[1]=b[1],this.storage[0]=b[0],this},d.prototype.setOuter=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=c[0]*d[0],this.storage[1]=c[0]*d[1],this.storage[2]=c[0]*d[2],this.storage[3]=c[1]*d[0],this.storage[4]=c[1]*d[1],this.storage[5]=c[1]*d[2],this.storage[6]=c[2]*d[0],this.storage[7]=c[2]*d[1],this.storage[8]=c[2]*d[2],this},d.prototype.splatDiagonal=function(a){return this.storage[0]=a,this.storage[4]=a,this.storage[8]=a,this},d.prototype.setDiagonal=function(a){var b=a.storage;return this.storage[0]=b[0],this.storage[4]=b[1],this.storage[8]=b[2],this},d.prototype.toString=function(){return"[0] "+this.getRow(0).toString()+"\n[1] "+this.getRow(1).toString()+"\n[2] "+this.getRow(2).toString()+"}\n"},d.prototype.getAt=function(a){return this.storage[a]},d.prototype.setAt=function(a,b){this.storage[a]=b},d.prototype.equals=function(a){return null==a.dimension||3!=a.dimension?!1:this.storage[0]==a.storage[0]&&this.storage[1]==a.storage[1]&&this.storage[2]==a.storage[2]&&this.storage[3]==a.storage[3]&&this.storage[4]==a.storage[4]&&this.storage[5]==a.storage[5]&&this.storage[6]==a.storage[6]&&this.storage[7]==a.storage[7]&&this.storage[8]==a.storage[8]},d.prototype.almostEquals=function(a,b){return null==a.dimension||3!=a.dimension?!1:(void 0===b&&(b=Number.EPSILON),Math.abs(this.storage[0]-a.storage[0])>b||Math.abs(this.storage[1]-a.storage[1])>b||Math.abs(this.storage[2]-a.storage[2])>b||Math.abs(this.storage[3]-a.storage[3])>b||Math.abs(this.storage[4]-a.storage[4])>b||Math.abs(this.storage[5]-a.storage[5])>b||Math.abs(this.storage[6]-a.storage[6])>b||Math.abs(this.storage[7]-a.storage[7])>b||Math.abs(this.storage[8]-a.storage[8])>b?!1:!0)},d.prototype.__defineGetter__("row0",function(){return this.getRow(0)}),d.prototype.__defineSetter__("row0",function(a){this.setRow(0,a)}),d.prototype.__defineGetter__("row1",function(){return this.getRow(1)}),d.prototype.__defineSetter__("row1",function(a){this.setRow(1,a)}),d.prototype.__defineGetter__("row2",function(){return this.getRow(2)}),d.prototype.__defineSetter__("row2",function(a){this.setRow(2,a)}),d.prototype.setRow=function(a,b){var c=b.storage;this.storage[this.index(a,0)]=c[0],this.storage[this.index(a,1)]=c[1],this.storage[this.index(a,2)]=c[2]},d.prototype.getRow=function(a){var b=e.zero(),c=b.storage;return c[0]=this.storage[this.index(a,0)],c[1]=this.storage[this.index(a,1)],c[2]=this.storage[this.index(a,2)],b},d.prototype.setColumn=function(a,b){var c=b.storage,d=3*a;return this.storage[d+2]=c[2],this.storage[d+1]=c[1],this.storage[d+0]=c[0],this},d.prototype.getColumn=function(a){var b=e.zero(),c=3*a,d=b.storage;return d[2]=this.storage[c+2],d[1]=this.storage[c+1],d[0]=this.storage[c+0],b},d.prototype.clone=function(){return d.copy(this)},d.prototype.copyInto=function(a){return a.setFrom(this),a},d.prototype.mult=function(a){return"Number"==typeof a?this.scaled(a):a instanceof e?this.transformed(a):3==a.dimension?this.multiplied(a):null},d.prototype.added=function(a){var b=this.clone();return b.add(a),b},d.prototype.subbed=function(a){var b=this.clone();return b.sub(a),b},d.prototype.negated=function(){var a=this.clone();return a.negate(),a},d.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this.storage[4]=0,this.storage[5]=0,this.storage[6]=0,this.storage[7]=0,this.storage[8]=0,this},d.prototype.setIdentity=function(){return this.storage[0]=1,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this.storage[4]=1,this.storage[5]=0,this.storage[6]=0,this.storage[7]=0,this.storage[8]=1,this},d.prototype.transposed=function(){var a=this.clone();return a.transpose(),a},d.prototype.transpose=function(){var a=this.storage[3];return this.storage[3]=this.storage[1],this.storage[1]=a,a=this.storage[6],this.storage[6]=this.storage[2],this.storage[2]=a,a=this.storage[7],this.storage[7]=this.storage[5],this.storage[5]=a,this},d.prototype.absolute=function(){var a=d.zero(),b=a.storage;return b[0]=Math.abs(this.storage[0]),b[1]=Math.abs(this.storage[1]),b[2]=Math.abs(this.storage[2]),b[3]=Math.abs(this.storage[3]),b[4]=Math.abs(this.storage[4]),b[5]=Math.abs(this.storage[5]),b[6]=Math.abs(this.storage[6]),b[7]=Math.abs(this.storage[7]),b[8]=Math.abs(this.storage[8]),a},d.prototype.determinant=function(){var a=this.storage[0]*(this.storage[4]*this.storage[8]-this.storage[5]*this.storage[7]),b=this.storage[1]*(this.storage[3]*this.storage[8]-this.storage[5]*this.storage[6]),c=this.storage[2]*(this.storage[3]*this.storage[7]-this.storage[4]*this.storage[6]);return a-b+c},d.prototype.dotRow=function(a,b){var c=b.storage;return this.storage[a]*c[0]+this.storage[3+a]*c[1]+this.storage[6+a]*c[2]},d.prototype.dotColumn=function(a,b){var c=b.storage;return this.storage[3*a]*c[0]+this.storage[3*a+1]*c[1]+this.storage[3*a+2]*c[2]},d.prototype.trace=function(){var a=0;return a+=this.storage[0],a+=this.storage[4],a+=this.storage[8]},d.prototype.infinityNorm=function(){var a=0,b=0;return b+=Math.abs(this.storage[0]),b+=Math.abs(this.storage[1]),b+=Math.abs(this.storage[2]),a=b>a?b:a,b=0,b+=Math.abs(this.storage[3]),b+=Math.abs(this.storage[4]),b+=Math.abs(this.storage[5]),a=b>a?b:a,b=0,b+=Math.abs(this.storage[6]),b+=Math.abs(this.storage[7]),b+=Math.abs(this.storage[8]),a=b>a?b:a,a},d.prototype.relativeError=function(a){var b=a.subbed(this),c=a.infinityNorm(),d=b.infinityNorm();return d/c},d.prototype.absoluteError=function(a){var b=this.infinityNorm(),c=a.infinityNorm(),d=Math.abs(b-c);return d},d.prototype.invert=function(){return this.copyInverse(this)},d.prototype.copyInverse=function(a){var b=a.determinant();if(0==b)return this.setFrom(a),0;var c=1/b,d=a.storage,e=c*(d[4]*d[8]-d[5]*d[7]),f=c*(d[2]*d[7]-d[1]*d[8]),g=c*(d[1]*d[5]-d[2]*d[4]),h=c*(d[5]*d[6]-d[3]*d[8]),i=c*(d[0]*d[8]-d[2]*d[6]),j=c*(d[2]*d[3]-d[0]*d[5]),k=c*(d[3]*d[7]-d[4]*d[6]),l=c*(d[1]*d[6]-d[0]*d[7]),m=c*(d[0]*d[4]-d[1]*d[3]);return this.storage[0]=e,this.storage[1]=f,this.storage[2]=g,this.storage[3]=h,this.storage[4]=i,this.storage[5]=j,this.storage[6]=k,this.storage[7]=l,this.storage[8]=m,b},d.prototype.copyNormalMatrix=function(a){return this.copyInverse(a.getRotation()),this.transpose(),this},d.prototype.setRotationX=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=1,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this.storage[4]=b,this.storage[5]=c,this.storage[6]=0,this.storage[7]=-c,this.storage[8]=b},d.prototype.setRotationY=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=b,this.storage[1]=0,this.storage[2]=c,this.storage[3]=0,this.storage[4]=1,this.storage[5]=0,this.storage[6]=-c,this.storage[7]=0,this.storage[8]=b},d.prototype.setRotationZ=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=b,this.storage[1]=c,this.storage[2]=0,this.storage[3]=-c,this.storage[4]=b,this.storage[5]=0,this.storage[6]=0,this.storage[7]=0,this.storage[8]=1},d.prototype.scaleAdjoint=function(a){var b=this.storage[0],c=this.storage[3],d=this.storage[6],e=this.storage[1],f=this.storage[4],g=this.storage[7],h=this.storage[2],i=this.storage[5],j=this.storage[8];return this.storage[0]=(f*j-g*i)*a,this.storage[1]=(g*h-e*j)*a,this.storage[2]=(e*i-f*h)*a,this.storage[3]=(d*i-c*j)*a,this.storage[4]=(b*j-d*h)*a,this.storage[5]=(c*h-b*i)*a,this.storage[6]=(c*g-d*f)*a,this.storage[7]=(d*e-b*g)*a,this.storage[8]=(b*f-c*e)*a,this},d.prototype.absoluteRotate=function(a){var b=Math.abs(this.storage[0]),c=Math.abs(this.storage[3]),d=Math.abs(this.storage[6]),e=Math.abs(this.storage[1]),f=Math.abs(this.storage[4]),g=Math.abs(this.storage[7]),h=Math.abs(this.storage[2]),i=Math.abs(this.storage[5]),j=Math.abs(this.storage[8]),k=a.storage,l=k[0],m=k[1],n=k[2];return k[0]=l*b+m*c+n*d,k[1]=l*e+m*f+n*g,k[2]=l*h+m*i+n*j,a},d.prototype.absoluteRotate2=function(a){var b=Math.abs(this.storage[0]),c=Math.abs(this.storage[3]),d=Math.abs(this.storage[1]),e=Math.abs(this.storage[4]),f=a.storage,g=f[0],h=f[1];return f[0]=g*b+h*c,f[1]=g*d+h*e,a},d.prototype.transform2=function(a){var b=a.storage,c=this.storage[0]*a.storage[0]+this.storage[3]*a.storage[1]+this.storage[6],d=this.storage[1]*a.storage[0]+this.storage[4]*a.storage[1]+this.storage[7];return b[0]=c,b[1]=d,a},d.prototype.scale=function(a){this.storage[0]=this.storage[0]*a,this.storage[1]=this.storage[1]*a,this.storage[2]=this.storage[2]*a,this.storage[3]=this.storage[3]*a,this.storage[4]=this.storage[4]*a,this.storage[5]=this.storage[5]*a,this.storage[6]=this.storage[6]*a,this.storage[7]=this.storage[7]*a,this.storage[8]=this.storage[8]*a},d.prototype.scaled=function(a){var b=this.clone();return b.scale(a),b},d.prototype.add=function(a){var b=a.storage;return this.storage[0]=this.storage[0]+b[0],this.storage[1]=this.storage[1]+b[1],this.storage[2]=this.storage[2]+b[2],this.storage[3]=this.storage[3]+b[3],this.storage[4]=this.storage[4]+b[4],this.storage[5]=this.storage[5]+b[5],this.storage[6]=this.storage[6]+b[6],this.storage[7]=this.storage[7]+b[7],this.storage[8]=this.storage[8]+b[8],this},d.prototype.sub=function(a){var b=a.storage;return this.storage[0]=this.storage[0]-b[0],this.storage[1]=this.storage[1]-b[1],this.storage[2]=this.storage[2]-b[2],this.storage[3]=this.storage[3]-b[3],this.storage[4]=this.storage[4]-b[4],this.storage[5]=this.storage[5]-b[5],this.storage[6]=this.storage[6]-b[6],this.storage[7]=this.storage[7]-b[7],this.storage[8]=this.storage[8]-b[8],this},d.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this.storage[2]=-this.storage[2],this.storage[3]=-this.storage[3],this.storage[4]=-this.storage[4],this.storage[5]=-this.storage[5],this.storage[6]=-this.storage[6],this.storage[7]=-this.storage[7],this.storage[8]=-this.storage[8],this},d.prototype.multiply=function(a){var b=this.storage[0],c=this.storage[3],d=this.storage[6],e=this.storage[1],f=this.storage[4],g=this.storage[7],h=this.storage[2],i=this.storage[5],j=this.storage[8],k=a.storage,l=k[0],m=k[3],n=k[6],o=k[1],p=k[4],q=k[7],r=k[2],s=k[5],t=k[8];return this.storage[0]=b*l+c*o+d*r,this.storage[3]=b*m+c*p+d*s,this.storage[6]=b*n+c*q+d*t,this.storage[1]=e*l+f*o+g*r,this.storage[4]=e*m+f*p+g*s,this.storage[7]=e*n+f*q+g*t,this.storage[2]=h*l+i*o+j*r,this.storage[5]=h*m+i*p+j*s,this.storage[8]=h*n+i*q+j*t,this},d.prototype.multiplied=function(a){var b=this.clone();return b.multiply(a),b},d.prototype.transposeMultiply=function(a){var b=this.storage[0],c=this.storage[1],d=this.storage[2],e=this.storage[3],f=this.storage[4],g=this.storage[5],h=this.storage[6],i=this.storage[7],j=this.storage[8],k=a.storage;return this.storage[0]=b*k[0]+c*a.storage[1]+d*a.storage[2],this.storage[3]=b*k[3]+c*a.storage[4]+d*a.storage[5],this.storage[6]=b*k[6]+c*a.storage[7]+d*a.storage[8],this.storage[1]=e*k[0]+f*a.storage[1]+g*a.storage[2],this.storage[4]=e*k[3]+f*a.storage[4]+g*a.storage[5],this.storage[7]=e*k[6]+f*a.storage[7]+g*a.storage[8],this.storage[2]=h*k[0]+i*a.storage[1]+j*a.storage[2],this.storage[5]=h*k[3]+i*a.storage[4]+j*a.storage[5],this.storage[8]=h*k[6]+i*a.storage[7]+j*a.storage[8],this},d.prototype.multiplyTranspose=function(a){var b=this.storage[0],c=this.storage[3],d=this.storage[6],e=this.storage[1],f=this.storage[4],g=this.storage[7],h=this.storage[2],i=this.storage[5],j=this.storage[8],k=a.storage;return this.storage[0]=b*k[0]+c*k[3]+d*k[6],this.storage[3]=b*k[1]+c*k[4]+d*k[7],
this.storage[6]=b*k[2]+c*k[5]+d*k[8],this.storage[1]=e*k[0]+f*k[3]+g*k[6],this.storage[4]=e*k[1]+f*k[4]+g*k[7],this.storage[7]=e*k[2]+f*k[5]+g*k[8],this.storage[2]=h*k[0]+i*k[3]+j*k[6],this.storage[5]=h*k[1]+i*k[4]+j*k[7],this.storage[8]=h*k[2]+i*k[5]+j*k[8],this},d.prototype.transform=function(a){var b=a.storage,c=this.storage[0]*b[0]+this.storage[3]*b[1]+this.storage[6]*b[2],d=this.storage[1]*b[0]+this.storage[4]*b[1]+this.storage[7]*b[2],e=this.storage[2]*b[0]+this.storage[5]*b[1]+this.storage[8]*b[2];return a.x=c,a.y=d,a.z=e,a},d.prototype.transformed=function(a){var b=e.copy(a);return this.transform(b)},d.prototype.copyFromArray=function(a,b){var c=b;void 0===b&&(c=0),this.storage[8]=a[c+8],this.storage[7]=a[c+7],this.storage[6]=a[c+6],this.storage[5]=a[c+5],this.storage[4]=a[c+4],this.storage[3]=a[c+3],this.storage[2]=a[c+2],this.storage[1]=a[c+1],this.storage[0]=a[c+0]},d.prototype.applyToVector3Array=function(a,b){var c=b;void 0===b&&(c=0);for(var d=0,c=b;d<a.length;d+=3,c+=3){var f=e.array(a,c);f.applyMatrix3(this),a[c]=f.storage[0],a[c+1]=f.storage[1],a[c+2]=f.storage[2]}return a}},{"./matrix2.js":3,"./quaternion.js":8,"./vector2.js":12,"./vector3.js":13}],5:[function(a,b,c){function d(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){this.storage=new Float32Array([a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p]),this.dimension=4}b.exports=d;var e=a("./matrix3.js"),f=a("./vector3.js"),g=a("./vector4.js");a("./quaternion.js");d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,16),c.clone()},d.solve2=function(a,b,c){var d=a.entry(0,0),e=a.entry(0,1),f=a.entry(1,0),g=a.entry(1,1),h=c.x-a.storage[8],i=c.y-a.storage[9],j=d*g-e*f;0!=j&&(j=1/j),b.x=j*(g*h-e*i),b.y=j*(d*i-f*h)},d.solve3=function(a,b,c){var d,e,f,g=a.entry(0,0),h=a.entry(1,0),i=a.entry(2,0),j=a.entry(0,1),k=a.entry(1,1),l=a.entry(2,1),m=a.entry(0,2),n=a.entry(1,2),o=a.entry(2,2),p=c.x-a.storage[12],q=c.y-a.storage[13],r=c.z-a.storage[14];d=k*o-l*n,e=l*m-j*o,f=j*n-k*m;var s=g*d+h*e+i*f;0!=s&&(s=1/s);var t=s*(p*d+q*e+r*f);d=-(n*r-o*q),e=-(o*p-m*r),f=-(m*q-n*p);var u=s*(g*d+h*e+i*f);d=-(q*l-r*k),e=-(r*j-p*l),f=-(p*k-q*j);var v=s*(g*d+h*e+i*f);b.x=t,b.y=u,b.z=v},d.solve=function(a,b,c){var d=a.storage[0],e=a.storage[1],f=a.storage[2],g=a.storage[3],h=a.storage[4],i=a.storage[5],j=a.storage[6],k=a.storage[7],l=a.storage[8],m=a.storage[9],n=a.storage[10],o=a.storage[11],p=a.storage[12],q=a.storage[13],r=a.storage[14],s=a.storage[15],t=d*i-e*h,u=d*j-f*h,v=d*k-g*h,w=e*j-f*i,x=e*k-g*i,y=f*k-g*j,z=l*q-m*p,A=l*r-n*p,B=l*s-o*p,C=m*r-n*q,D=m*s-o*q,E=n*s-o*r,F=c.storage[0],G=c.storage[1],H=c.storage[2],I=c.storage[3],J=t*E-u*D+v*C+w*B-x*A+y*z;0!=J&&(J=1/J),b.x=J*((i*E-j*D+k*C)*F-(h*E-j*B+k*A)*G+(h*D-i*B+k*z)*H-(h*C-i*A+j*z)*I),b.y=J*-((e*E-f*D+g*C)*F-(d*E-f*B+g*A)*G+(d*D-e*B+g*z)*H-(d*C-e*A+f*z)*I),b.z=J*((q*y-r*x+s*w)*F-(p*y-r*v+s*u)*G+(p*x-q*v+s*t)*H-(p*w-q*u+r*t)*I),b.w=J*-((m*y-n*x+o*w)*F-(l*y-n*v+o*u)*G+(l*x-m*v+o*t)*H-(l*w-m*u+n*t)*I)},d.prototype.index=function(a,b){return 4*b+a},d.prototype.entry=function(a,b){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:this.storage[this.index(a,b)]},d.prototype.setEntry=function(a,b,c){return 0==(a>=0&&a<this.dimension)?null:0==(b>=0&&b<this.dimension)?null:void(this.storage[this.index(a,b)]=c)},d.zero=function(){var a=new d(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return a},d.identity=function(){var a=d.zero();return a.setIdentity(),a},d.copy=function(a){var b=d.zero();return b.setFrom(a),b},d.columns=function(a,b,c,e){var f=d.zero();return f.setColumns(a,b,c,e),f},d.outer=function(a,b){var c=d.zero();return c.setOuter(a,b),c},d.rotation=function(a){var b=d.zero();return b.setRotation(a),b},d.rotationX=function(a){var b=d.zero();return b.storage[15]=1,b.setRotationX(a),b},d.rotationY=function(a){var b=d.zero();return b.storage[15]=1,b.setRotationY(a),b},d.rotationZ=function(a){var b=d.zero();return b.storage[15]=1,b.setRotationZ(a),b},d.translation=function(a){var b=d.zero();return b.setIdentity(),b.setDiagonal(a),b},d.diagonalValues=function(a,b,c,e){var f=d.zero();return f.setIdentity(),f.setDiagonal(new g(a,b,c,e)),f},d.translation=function(a){var b=d.zero();return b.setIdentity(),b.setTranslation(a),b},d.translationValues=function(a,b,c){var e=d.zero();return e.setIdentity(),e.setTranslation(new f(a,b,c)),e},d.compose=function(a,b,c){var e=d.zero();return e.setFromTranslationRotationScale(a,b,c),e},d.prototype.splatDiagonal=function(a){return this.storage[0]=a,this.storage[5]=a,this.storage[10]=a,this.storage[15]=a,this},d.prototype.setValues=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return this.storage[15]=p,this.storage[14]=o,this.storage[13]=n,this.storage[12]=m,this.storage[11]=l,this.storage[10]=k,this.storage[9]=j,this.storage[8]=i,this.storage[7]=h,this.storage[6]=g,this.storage[5]=f,this.storage[4]=e,this.storage[3]=d,this.storage[2]=c,this.storage[1]=b,this.storage[0]=a,this},d.prototype.setColumns=function(a,b,c,d){var e=a.storage,f=b.storage,g=c.storage,h=d.storage;return this.storage[0]=e[0],this.storage[1]=e[1],this.storage[2]=e[2],this.storage[3]=e[3],this.storage[4]=f[0],this.storage[5]=f[1],this.storage[6]=f[2],this.storage[7]=f[3],this.storage[8]=g[0],this.storage[9]=g[1],this.storage[10]=g[2],this.storage[11]=g[3],this.storage[12]=h[0],this.storage[13]=h[1],this.storage[14]=h[2],this.storage[15]=h[3],this},d.prototype.setFrom=function(a){var b=a.storage;return this.storage[15]=b[15],this.storage[14]=b[14],this.storage[13]=b[13],this.storage[12]=b[12],this.storage[11]=b[11],this.storage[10]=b[10],this.storage[9]=b[9],this.storage[8]=b[8],this.storage[7]=b[7],this.storage[6]=b[6],this.storage[5]=b[5],this.storage[4]=b[4],this.storage[3]=b[3],this.storage[2]=b[2],this.storage[1]=b[1],this.storage[0]=b[0],this},d.prototype.setFromTranslationRotation=function(a,b){var c=b.storage,d=c[0],e=c[1],f=c[2],g=c[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j,t=a.storage;return this.storage[0]=1-(n+p),this.storage[1]=l+s,this.storage[2]=m-r,this.storage[3]=0,this.storage[4]=l-s,this.storage[5]=1-(k+p),this.storage[6]=o+q,this.storage[7]=0,this.storage[8]=m+r,this.storage[9]=o-q,this.storage[10]=1-(k+n),this.storage[11]=0,this.storage[12]=t[0],this.storage[13]=t[1],this.storage[14]=t[2],this.storage[15]=1,this},d.prototype.setFromTranslationRotationScale=function(a,b,c){return this.setFromTranslationRotation(a,b),this.scale(c),this},d.prototype.setUpper2x2=function(a){var b=a.storage;return this.storage[0]=b[0],this.storage[1]=b[1],this.storage[4]=b[2],this.storage[5]=b[3],this},d.prototype.setDiagonal=function(a){var b=a.storage;return this.storage[0]=b[0],this.storage[5]=b[1],this.storage[10]=b[2],this.storage[15]=b[3],this},d.prototype.setOuter=function(a,b){var c=a.storage,d=b.storage;this.storage[0]=c[0]*d[0],this.storage[1]=c[0]*d[1],this.storage[2]=c[0]*d[2],this.storage[3]=c[0]*d[3],this.storage[4]=c[1]*d[0],this.storage[5]=c[1]*d[1],this.storage[6]=c[1]*d[2],this.storage[7]=c[1]*d[3],this.storage[8]=c[2]*d[0],this.storage[9]=c[2]*d[1],this.storage[10]=c[2]*d[2],this.storage[11]=c[2]*d[3],this.storage[12]=c[3]*d[0],this.storage[13]=c[3]*d[1],this.storage[14]=c[3]*d[2],this.storage[15]=c[3]*d[3]},d.prototype.toString=function(){return"[0] "+this.getRow(0).toString()+"\n[1] "+this.getRow(1).toString()+"\n[2] "+this.getRow(2).toString()+"\n[3] "+this.getRow(3).toString()+"}\n"},d.prototype.getAt=function(a){return this.storage[a]},d.prototype.setAt=function(a,b){this.storage[a]=b},d.prototype.equals=function(a){return null==a.dimension||4!=a.dimension?!1:this.storage[0]==a.storage[0]&&this.storage[1]==a.storage[1]&&this.storage[2]==a.storage[2]&&this.storage[3]==a.storage[3]&&this.storage[4]==a.storage[4]&&this.storage[5]==a.storage[5]&&this.storage[6]==a.storage[6]&&this.storage[7]==a.storage[7]&&this.storage[8]==a.storage[8]&&this.storage[9]==a.storage[9]&&this.storage[10]==a.storage[10]&&this.storage[11]==a.storage[11]&&this.storage[12]==a.storage[12]&&this.storage[13]==a.storage[13]&&this.storage[14]==a.storage[14]&&this.storage[15]==a.storage[15]},d.prototype.almostEquals=function(a,b){return null==a.dimension||4!=a.dimension?!1:(void 0===b&&(b=Number.EPSILON),Math.abs(this.storage[0]-a.storage[0])>b||Math.abs(this.storage[1]-a.storage[1])>b||Math.abs(this.storage[2]-a.storage[2])>b||Math.abs(this.storage[3]-a.storage[3])>b||Math.abs(this.storage[4]-a.storage[4])>b||Math.abs(this.storage[5]-a.storage[5])>b||Math.abs(this.storage[6]-a.storage[6])>b||Math.abs(this.storage[7]-a.storage[7])>b||Math.abs(this.storage[8]-a.storage[8])>b||Math.abs(this.storage[9]-a.storage[9])>b||Math.abs(this.storage[10]-a.storage[10])>b||Math.abs(this.storage[11]-a.storage[11])>b||Math.abs(this.storage[12]-a.storage[12])>b||Math.abs(this.storage[13]-a.storage[13])>b||Math.abs(this.storage[14]-a.storage[14])>b||Math.abs(this.storage[15]-a.storage[15])>b?!1:!0)},d.prototype.__defineGetter__("row0",function(){return this.getRow(0)}),d.prototype.__defineSetter__("row0",function(a){this.setRow(0,a)}),d.prototype.__defineGetter__("row1",function(){return this.getRow(1)}),d.prototype.__defineSetter__("row1",function(a){this.setRow(1,a)}),d.prototype.__defineGetter__("row2",function(){return this.getRow(2)}),d.prototype.__defineSetter__("row2",function(a){this.setRow(2,a)}),d.prototype.__defineGetter__("row3",function(){return this.getRow(3)}),d.prototype.__defineSetter__("row3",function(a){this.setRow(3,a)}),d.prototype.setRow=function(a,b){var c=b.storage;this.storage[this.index(a,0)]=c[0],this.storage[this.index(a,1)]=c[1],this.storage[this.index(a,2)]=c[2],this.storage[this.index(a,3)]=c[3]},d.prototype.getRow=function(a){var b=g.zero(),c=b.storage;return c[0]=this.storage[this.index(a,0)],c[1]=this.storage[this.index(a,1)],c[2]=this.storage[this.index(a,2)],c[3]=this.storage[this.index(a,3)],b},d.prototype.setColumn=function(a,b){var c=b.storage,d=3*a;return this.storage[d+3]=c[3],this.storage[d+2]=c[2],this.storage[d+1]=c[1],this.storage[d+0]=c[0],this},d.prototype.getColumn=function(a){var b=g.zero(),c=3*a,d=b.storage;return d[3]=this.storage[c+3],d[2]=this.storage[c+2],d[1]=this.storage[c+1],d[0]=this.storage[c+0],b},d.prototype.clone=function(){return d.copy(this)},d.prototype.copyInto=function(a){return a.setFrom(this),a},d.prototype.mult=function(a){return"Number"==typeof a?this.scaled(a):a instanceof g?this.transformed(a):a instanceof f?this.transformed3(a):4==a.dimension?this.multiplied(a):null},d.prototype.added=function(a){var b=this.clone();return b.add(a),b},d.prototype.subbed=function(a){var b=this.clone();return b.sub(a),b},d.prototype.negated=function(){var a=this.clone();return a.negate(),a},d.prototype.translate=function(a,b,c){var d,e,h,i=a instanceof g?a.w:1;a instanceof f||a instanceof g?(d=a.x,e=a.y,h=a.z):(d=a,e=b,h=c);var j=this.storage[0]*d+this.storage[4]*e+this.storage[8]*h+this.storage[12]*i,k=this.storage[1]*d+this.storage[5]*e+this.storage[9]*h+this.storage[13]*i,l=this.storage[2]*d+this.storage[6]*e+this.storage[10]*h+this.storage[14]*i,m=this.storage[3]*d+this.storage[7]*e+this.storage[11]*h+this.storage[15]*i;return this.storage[12]=j,this.storage[13]=k,this.storage[14]=l,this.storage[15]=m,this},d.prototype.rotate=function(a,b){var c=a.length,d=a.storage,e=d[0]/c,f=d[1]/c,g=d[2]/c,h=Math.cos(b),i=Math.sin(b),j=1-h,k=e*e*j+h,l=e*f*j-g*i,m=e*g*j+f*i,n=f*e*j+g*i,o=f*f*j+h,p=f*g*j-e*i,q=g*e*j-f*i,r=g*f*j+e*i,s=g*g*j+h,t=this.storage[0]*k+this.storage[4]*n+this.storage[8]*q,u=this.storage[1]*k+this.storage[5]*n+this.storage[9]*q,v=this.storage[2]*k+this.storage[6]*n+this.storage[10]*q,w=this.storage[3]*k+this.storage[7]*n+this.storage[11]*q,x=this.storage[0]*l+this.storage[4]*o+this.storage[8]*r,y=this.storage[1]*l+this.storage[5]*o+this.storage[9]*r,z=this.storage[2]*l+this.storage[6]*o+this.storage[10]*r,A=this.storage[3]*l+this.storage[7]*o+this.storage[11]*r,B=this.storage[0]*m+this.storage[4]*p+this.storage[8]*s,C=this.storage[1]*m+this.storage[5]*p+this.storage[9]*s,D=this.storage[2]*m+this.storage[6]*p+this.storage[10]*s,E=this.storage[3]*m+this.storage[7]*p+this.storage[11]*s;return this.storage[0]=t,this.storage[1]=u,this.storage[2]=v,this.storage[3]=w,this.storage[4]=x,this.storage[5]=y,this.storage[6]=z,this.storage[7]=A,this.storage[8]=B,this.storage[9]=C,this.storage[10]=D,this.storage[11]=E,this},d.prototype.rotateX=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.storage[4]*b+this.storage[8]*c,e=this.storage[5]*b+this.storage[9]*c,f=this.storage[6]*b+this.storage[10]*c,g=this.storage[7]*b+this.storage[11]*c,h=this.storage[4]*-c+this.storage[8]*b,i=this.storage[5]*-c+this.storage[9]*b,j=this.storage[6]*-c+this.storage[10]*b,k=this.storage[7]*-c+this.storage[11]*b;return this.storage[4]=d,this.storage[5]=e,this.storage[6]=f,this.storage[7]=g,this.storage[8]=h,this.storage[9]=i,this.storage[10]=j,this.storage[11]=k,this},d.prototype.rotateY=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.storage[0]*b+this.storage[8]*-c,e=this.storage[1]*b+this.storage[9]*-c,f=this.storage[2]*b+this.storage[10]*-c,g=this.storage[3]*b+this.storage[11]*-c,h=this.storage[0]*c+this.storage[8]*b,i=this.storage[1]*c+this.storage[9]*b,j=this.storage[2]*c+this.storage[10]*b,k=this.storage[3]*c+this.storage[11]*b;return this.storage[0]=d,this.storage[1]=e,this.storage[2]=f,this.storage[3]=g,this.storage[8]=h,this.storage[9]=i,this.storage[10]=j,this.storage[11]=k,this},d.prototype.rotateZ=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.storage[0]*b+this.storage[4]*c,e=this.storage[1]*b+this.storage[5]*c,f=this.storage[2]*b+this.storage[6]*c,g=this.storage[3]*b+this.storage[7]*c,h=this.storage[0]*-c+this.storage[4]*b,i=this.storage[1]*-c+this.storage[5]*b,j=this.storage[2]*-c+this.storage[6]*b,k=this.storage[3]*-c+this.storage[7]*b;return this.storage[0]=d,this.storage[1]=e,this.storage[2]=f,this.storage[3]=g,this.storage[4]=h,this.storage[5]=i,this.storage[6]=j,this.storage[7]=k,this},d.prototype.scale=function(a,b,c){var d,e,h,i=a instanceof g?a.w:1;return a instanceof f||a instanceof g?(d=a.x,e=a.y,h=a.z):(d=a,e=b,h=c),this.storage[0]*=d,this.storage[1]*=d,this.storage[2]*=d,this.storage[3]*=d,this.storage[4]*=e,this.storage[5]*=e,this.storage[6]*=e,this.storage[7]*=e,this.storage[8]*=h,this.storage[9]*=h,this.storage[10]*=h,this.storage[11]*=h,this.storage[12]*=i,this.storage[13]*=i,this.storage[14]*=i,this.storage[15]*=i,this},d.prototype.scaled=function(a,b,c){var d=this.clone();return d.scale(a,b,c),d},d.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this.storage[4]=0,this.storage[5]=0,this.storage[6]=0,this.storage[7]=0,this.storage[8]=0,this.storage[9]=0,this.storage[10]=0,this.storage[11]=0,this.storage[12]=0,this.storage[13]=0,this.storage[14]=0,this.storage[15]=0,this},d.prototype.setIdentity=function(){return this.storage[0]=1,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this.storage[4]=0,this.storage[5]=1,this.storage[6]=0,this.storage[7]=0,this.storage[8]=0,this.storage[9]=0,this.storage[10]=1,this.storage[11]=0,this.storage[12]=0,this.storage[13]=0,this.storage[14]=0,this.storage[15]=1,this},d.prototype.transposed=function(){var a=this.clone();return a.transpose(),a},d.prototype.transpose=function(){var a;return a=this.storage[4],this.storage[4]=this.storage[1],this.storage[1]=a,a=this.storage[8],this.storage[8]=this.storage[2],this.storage[2]=a,a=this.storage[12],this.storage[12]=this.storage[3],this.storage[3]=a,a=this.storage[9],this.storage[9]=this.storage[6],this.storage[6]=a,a=this.storage[13],this.storage[13]=this.storage[7],this.storage[7]=a,a=this.storage[14],this.storage[14]=this.storage[11],this.storage[11]=a,this},d.prototype.absolute=function(){var a=d.zero(),b=a.storage;return b[0]=Math.abs(this.storage[0]),b[1]=Math.abs(this.storage[1]),b[2]=Math.abs(this.storage[2]),b[3]=Math.abs(this.storage[3]),b[4]=Math.abs(this.storage[4]),b[5]=Math.abs(this.storage[5]),b[6]=Math.abs(this.storage[6]),b[7]=Math.abs(this.storage[7]),b[8]=Math.abs(this.storage[8]),b[9]=Math.abs(this.storage[9]),b[10]=Math.abs(this.storage[10]),b[11]=Math.abs(this.storage[11]),b[12]=Math.abs(this.storage[12]),b[13]=Math.abs(this.storage[13]),b[14]=Math.abs(this.storage[14]),b[15]=Math.abs(this.storage[15]),a},d.prototype.determinant=function(){var a=this.storage[0]*this.storage[5]-this.storage[1]*this.storage[4],b=this.storage[0]*this.storage[6]-this.storage[2]*this.storage[4],c=this.storage[0]*this.storage[7]-this.storage[3]*this.storage[4],d=this.storage[1]*this.storage[6]-this.storage[2]*this.storage[5],e=this.storage[1]*this.storage[7]-this.storage[3]*this.storage[5],f=this.storage[2]*this.storage[7]-this.storage[3]*this.storage[6],g=this.storage[8]*d-this.storage[9]*b+this.storage[10]*a,h=this.storage[8]*e-this.storage[9]*c+this.storage[11]*a,i=this.storage[8]*f-this.storage[10]*c+this.storage[11]*b,j=this.storage[9]*f-this.storage[10]*e+this.storage[11]*d;return-j*this.storage[12]+i*this.storage[13]-h*this.storage[14]+g*this.storage[15]},d.prototype.dotRow=function(a,b){var c=b.storage;return this.storage[a]*c[0]+this.storage[4+a]*c[1]+this.storage[8+a]*c[2]+this.storage[12+a]*c[3]},d.prototype.dotColumn=function(a,b){var c=b.storage;return this.storage[4*a]*c[0]+this.storage[4*a+1]*c[1]+this.storage[4*a+2]*c[2]+this.storage[4*a+3]*c[3]},d.prototype.trace=function(){var a=0;return a+=this.storage[0],a+=this.storage[5],a+=this.storage[10],a+=this.storage[15]},d.prototype.infinityNorm=function(){var a=0,b=0;return b+=Math.abs(this.storage[0]),b+=Math.abs(this.storage[1]),b+=Math.abs(this.storage[2]),b+=Math.abs(this.storage[3]),a=b>a?b:a,b=0,b+=Math.abs(this.storage[4]),b+=Math.abs(this.storage[5]),b+=Math.abs(this.storage[6]),b+=Math.abs(this.storage[7]),a=b>a?b:a,b=0,b+=Math.abs(this.storage[8]),b+=Math.abs(this.storage[9]),b+=Math.abs(this.storage[10]),b+=Math.abs(this.storage[11]),a=b>a?b:a,b=0,b+=Math.abs(this.storage[12]),b+=Math.abs(this.storage[13]),b+=Math.abs(this.storage[14]),b+=Math.abs(this.storage[15]),a=b>a?b:a,a},d.prototype.relativeError=function(a){var b=a.subbed(this),c=a.infinityNorm(),d=b.infinityNorm();return d/c},d.prototype.absoluteError=function(a){var b=this.infinityNorm(),c=a.infinityNorm(),d=Math.abs(b-c);return d},d.prototype.getTranslation=function(){var a=this.storage[14],b=this.storage[13],c=this.storage[12];return new f(c,b,a)},d.prototype.setTranslation=function(a){var b=a.storage,c=b[2],d=b[1],e=b[0];this.storage[14]=c,this.storage[13]=d,this.storage[12]=e},d.prototype.getRotation=function(){var a=e.zero();return this.copyRotation(a),a},d.prototype.copyRotation=function(a){var b=a.storage;b[0]=this.storage[0],b[1]=this.storage[1],b[2]=this.storage[2],b[3]=this.storage[4],b[4]=this.storage[5],b[5]=this.storage[6],b[6]=this.storage[8],b[7]=this.storage[9],b[8]=this.storage[10]},d.prototype.setRotation=function(a){var b=a.storage;this.storage[0]=b[0],this.storage[1]=b[1],this.storage[2]=b[2],this.storage[4]=b[3],this.storage[5]=b[4],this.storage[6]=b[5],this.storage[8]=b[6],this.storage[9]=b[7],this.storage[10]=b[8]},d.prototype.getNormalMatrix=function(){var a=e.identity();return a.copyNormalMatrix(this),a},d.prototype.getMaxScaleOnAxis=function(){var a=this.storage[0]*this.storage[0]+this.storage[1]*this.storage[1]+this.storage[2]*this.storage[2],b=this.storage[4]*this.storage[4]+this.storage[5]*this.storage[5]+this.storage[6]*this.storage[6],c=this.storage[8]*this.storage[8]+this.storage[9]*this.storage[9]+this.storage[10]*this.storage[10];return Math.sqrt(Math.max(a,Math.max(b,c)))},d.prototype.transposeRotation=function(){var a;return a=this.storage[1],this.storage[1]=this.storage[4],this.storage[4]=a,a=this.storage[2],this.storage[2]=this.storage[8],this.storage[8]=a,a=this.storage[4],this.storage[4]=this.storage[1],this.storage[1]=a,a=this.storage[6],this.storage[6]=this.storage[9],this.storage[9]=a,a=this.storage[8],this.storage[8]=this.storage[2],this.storage[2]=a,a=this.storage[9],this.storage[9]=this.storage[6],this.storage[6]=a,this},d.prototype.invert=function(){this.copyInverse(this)},d.prototype.copyInverse=function(a){var b=a.storage,c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;if(0==E)return this.setFrom(a),0;var F=1/E;return this.storage[0]=(h*D-i*C+j*B)*F,this.storage[1]=(-d*D+e*C-f*B)*F,this.storage[2]=(p*x-q*w+r*v)*F,this.storage[3]=(-l*x+m*w-n*v)*F,this.storage[4]=(-g*D+i*A-j*z)*F,this.storage[5]=(c*D-e*A+f*z)*F,this.storage[6]=(-o*x+q*u-r*t)*F,this.storage[7]=(k*x-m*u+n*t)*F,this.storage[8]=(g*C-h*A+j*y)*F,this.storage[9]=(-c*C+d*A-f*y)*F,this.storage[10]=(o*w-p*u+r*s)*F,this.storage[11]=(-k*w+l*u-n*s)*F,this.storage[12]=(-g*B+h*z-i*y)*F,this.storage[13]=(c*B-d*z+e*y)*F,this.storage[14]=(-o*v+p*t-q*s)*F,this.storage[15]=(k*v-l*t+m*s)*F,E},d.prototype.invertRotation=function(){var a=this.determinant();if(0==a)return 0;var b,c,d,e,f,g,h,i,j,k=1/a;return b=k*(this.storage[5]*this.storage[10]-this.storage[6]*this.storage[9]),c=k*(this.storage[2]*this.storage[9]-this.storage[1]*this.storage[10]),d=k*(this.storage[1]*this.storage[6]-this.storage[2]*this.storage[5]),e=k*(this.storage[6]*this.storage[8]-this.storage[4]*this.storage[10]),f=k*(this.storage[0]*this.storage[10]-this.storage[2]*this.storage[8]),g=k*(this.storage[2]*this.storage[4]-this.storage[0]*this.storage[6]),h=k*(this.storage[4]*this.storage[9]-this.storage[5]*this.storage[8]),i=k*(this.storage[1]*this.storage[8]-this.storage[0]*this.storage[9]),j=k*(this.storage[0]*this.storage[5]-this.storage[1]*this.storage[4]),this.storage[0]=b,this.storage[1]=c,this.storage[2]=d,this.storage[4]=e,this.storage[5]=f,this.storage[6]=g,this.storage[8]=h,this.storage[9]=i,this.storage[10]=j,a},d.prototype.setRotationX=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=1,this.storage[1]=0,this.storage[2]=0,this.storage[4]=0,this.storage[5]=b,this.storage[6]=c,this.storage[8]=0,this.storage[9]=-c,this.storage[10]=b,this.storage[3]=0,this.storage[7]=0,this.storage[11]=0},d.prototype.setRotationY=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=b,this.storage[1]=0,this.storage[2]=-c,this.storage[4]=0,this.storage[5]=1,this.storage[6]=0,this.storage[8]=c,this.storage[9]=0,this.storage[10]=b,this.storage[3]=0,this.storage[7]=0,this.storage[11]=0},d.prototype.setRotationZ=function(a){var b=Math.cos(a),c=Math.sin(a);this.storage[0]=b,this.storage[1]=c,this.storage[2]=0,this.storage[4]=-c,this.storage[5]=b,this.storage[6]=0,this.storage[8]=0,this.storage[9]=0,this.storage[10]=1,this.storage[3]=0,this.storage[7]=0,this.storage[11]=0},d.prototype.scaleAdjoint=function(a){var b=this.storage[0],c=this.storage[4],d=this.storage[8],e=this.storage[12],f=this.storage[1],g=this.storage[5],h=this.storage[9],i=this.storage[13],j=this.storage[2],k=this.storage[6],l=this.storage[10],m=this.storage[14],n=this.storage[3],o=this.storage[7],p=this.storage[11],q=this.storage[15];return this.storage[0]=(g*(l*q-p*m)-h*(k*q-o*m)+i*(k*p-o*l))*a,this.storage[1]=-(f*(l*q-p*m)-h*(j*q-n*m)+i*(j*p-n*l))*a,this.storage[2]=(f*(k*q-o*m)-g*(j*q-n*m)+i*(j*o-n*k))*a,this.storage[3]=-(f*(k*p-o*l)-g*(j*p-n*l)+h*(j*o-n*k))*a,this.storage[4]=-(c*(l*q-p*m)-d*(k*q-o*m)+e*(k*p-o*l))*a,this.storage[5]=(b*(l*q-p*m)-d*(j*q-n*m)+e*(j*p-n*l))*a,this.storage[6]=-(b*(k*q-o*m)-c*(j*q-n*m)+e*(j*o-n*k))*a,this.storage[7]=(b*(k*p-o*l)-c*(j*p-n*l)+d*(j*o-n*k))*a,this.storage[8]=(c*(h*q-p*i)-d*(g*q-o*i)+e*(g*p-o*h))*a,this.storage[9]=-(b*(h*q-p*i)-d*(f*q-n*i)+e*(f*p-n*h))*a,this.storage[10]=(b*(g*q-o*i)-c*(f*q-n*i)+e*(f*o-n*g))*a,this.storage[11]=-(b*(g*p-o*h)-c*(f*p-n*h)+d*(f*o-n*g))*a,this.storage[12]=-(c*(h*m-l*i)-d*(g*m-k*i)+e*(g*l-k*h))*a,this.storage[13]=(b*(h*m-l*i)-d*(f*m-j*i)+e*(f*l-j*h))*a,this.storage[14]=-(b*(g*m-k*i)-c*(f*m-j*i)+e*(f*k-j*g))*a,this.storage[15]=(b*(g*l-k*h)-c*(f*l-j*h)+d*(f*k-j*g))*a,this},d.prototype.absoluteRotate=function(a){var b=Math.abs(this.storage[0]),c=Math.abs(this.storage[4]),d=Math.abs(this.storage[8]),e=Math.abs(this.storage[1]),f=Math.abs(this.storage[5]),g=Math.abs(this.storage[9]),h=Math.abs(this.storage[2]),i=Math.abs(this.storage[6]),j=Math.abs(this.storage[10]),k=a.storage,l=k[0],m=k[1],n=k[2];return k[0]=l*b+m*c+n*d,k[1]=l*e+m*f+n*g,k[2]=l*h+m*i+n*j,a},d.prototype.add=function(a){var b=a.storage;return this.storage[0]=this.storage[0]+b[0],this.storage[1]=this.storage[1]+b[1],this.storage[2]=this.storage[2]+b[2],this.storage[3]=this.storage[3]+b[3],this.storage[4]=this.storage[4]+b[4],this.storage[5]=this.storage[5]+b[5],this.storage[6]=this.storage[6]+b[6],this.storage[7]=this.storage[7]+b[7],this.storage[8]=this.storage[8]+b[8],this.storage[9]=this.storage[9]+b[9],this.storage[10]=this.storage[10]+b[10],this.storage[11]=this.storage[11]+b[11],this.storage[12]=this.storage[12]+b[12],this.storage[13]=this.storage[13]+b[13],this.storage[14]=this.storage[14]+b[14],this.storage[15]=this.storage[15]+b[15],this},d.prototype.sub=function(a){var b=a.storage;return this.storage[0]=this.storage[0]-b[0],this.storage[1]=this.storage[1]-b[1],this.storage[2]=this.storage[2]-b[2],this.storage[3]=this.storage[3]-b[3],this.storage[4]=this.storage[4]-b[4],this.storage[5]=this.storage[5]-b[5],this.storage[6]=this.storage[6]-b[6],this.storage[7]=this.storage[7]-b[7],this.storage[8]=this.storage[8]-b[8],this.storage[9]=this.storage[9]-b[9],this.storage[10]=this.storage[10]-b[10],this.storage[11]=this.storage[11]-b[11],this.storage[12]=this.storage[12]-b[12],this.storage[13]=this.storage[13]-b[13],this.storage[14]=this.storage[14]-b[14],this.storage[15]=this.storage[15]-b[15],this},d.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this.storage[2]=-this.storage[2],this.storage[3]=-this.storage[3],this.storage[4]=-this.storage[4],this.storage[5]=-this.storage[5],this.storage[6]=-this.storage[6],this.storage[7]=-this.storage[7],this.storage[8]=-this.storage[8],this.storage[9]=-this.storage[9],this.storage[10]=-this.storage[10],this.storage[11]=-this.storage[11],this.storage[12]=-this.storage[12],this.storage[13]=-this.storage[13],this.storage[14]=-this.storage[14],this.storage[15]=-this.storage[15],this},d.prototype.multiply=function(a){var b=this.storage[0],c=this.storage[4],d=this.storage[8],e=this.storage[12],f=this.storage[1],g=this.storage[5],h=this.storage[9],i=this.storage[13],j=this.storage[2],k=this.storage[6],l=this.storage[10],m=this.storage[14],n=this.storage[3],o=this.storage[7],p=this.storage[11],q=this.storage[15],r=a.storage,s=r[0],t=r[4],u=r[8],v=r[12],w=r[1],x=r[5],y=r[9],z=r[13],A=r[2],B=r[6],C=r[10],D=r[14],E=r[3],F=r[7],G=r[11],H=r[15];return this.storage[0]=b*s+c*w+d*A+e*E,this.storage[4]=b*t+c*x+d*B+e*F,this.storage[8]=b*u+c*y+d*C+e*G,this.storage[12]=b*v+c*z+d*D+e*H,this.storage[1]=f*s+g*w+h*A+i*E,this.storage[5]=f*t+g*x+h*B+i*F,this.storage[9]=f*u+g*y+h*C+i*G,this.storage[13]=f*v+g*z+h*D+i*H,this.storage[2]=j*s+k*w+l*A+m*E,this.storage[6]=j*t+k*x+l*B+m*F,this.storage[10]=j*u+k*y+l*C+m*G,this.storage[14]=j*v+k*z+l*D+m*H,this.storage[3]=n*s+o*w+p*A+q*E,this.storage[7]=n*t+o*x+p*B+q*F,this.storage[11]=n*u+o*y+p*C+q*G,this.storage[15]=n*v+o*z+p*D+q*H,this},d.prototype.multiplied=function(a){var b=this.clone();return b.multiply(a),b},d.prototype.transposeMultiply=function(a){var b=this.storage[0],c=this.storage[1],d=this.storage[2],e=this.storage[3],f=this.storage[4],g=this.storage[5],h=this.storage[6],i=this.storage[7],j=this.storage[8],k=this.storage[9],l=this.storage[10],m=this.storage[11],n=this.storage[12],o=this.storage[13],p=this.storage[14],q=this.storage[15],r=a.storage;return this.storage[0]=b*r[0]+c*r[1]+d*r[2]+e*r[3],this.storage[4]=b*r[4]+c*r[5]+d*r[6]+e*r[7],this.storage[8]=b*r[8]+c*r[9]+d*r[10]+e*r[11],this.storage[12]=b*r[12]+c*r[13]+d*r[14]+e*r[15],this.storage[1]=f*r[0]+g*r[1]+h*r[2]+i*r[3],this.storage[5]=f*r[4]+g*r[5]+h*r[6]+i*r[7],this.storage[9]=f*r[8]+g*r[9]+h*r[10]+i*r[11],this.storage[13]=f*r[12]+g*r[13]+h*r[14]+i*r[15],this.storage[2]=j*r[0]+k*r[1]+l*r[2]+m*r[3],this.storage[6]=j*r[4]+k*r[5]+l*r[6]+m*r[7],this.storage[10]=j*r[8]+k*r[9]+l*r[10]+m*r[11],this.storage[14]=j*r[12]+k*r[13]+l*r[14]+m*r[15],this.storage[3]=n*r[0]+o*r[1]+p*r[2]+q*r[3],this.storage[7]=n*r[4]+o*r[5]+p*r[6]+q*r[7],this.storage[11]=n*r[8]+o*r[9]+p*r[10]+q*r[11],this.storage[15]=n*r[12]+o*r[13]+p*r[14]+q*r[15],this},d.prototype.multiplyTranspose=function(a){var b=this.storage[0],c=this.storage[4],d=this.storage[8],e=this.storage[12],f=this.storage[1],g=this.storage[5],h=this.storage[9],i=this.storage[13],j=this.storage[2],k=this.storage[6],l=this.storage[10],m=this.storage[14],n=this.storage[3],o=this.storage[7],p=this.storage[11],q=this.storage[15],r=a.storage;return this.storage[0]=b*r[0]+c*r[4]+d*r[8]+e*r[12],this.storage[4]=b*r[1]+c*r[5]+d*r[9]+e*r[13],this.storage[8]=b*r[2]+c*r[6]+d*r[10]+e*r[14],this.storage[12]=b*r[3]+c*r[7]+d*r[11]+e*r[15],this.storage[1]=f*r[0]+g*r[4]+h*r[8]+i*r[12],this.storage[5]=f*r[1]+g*r[5]+h*r[9]+i*r[13],this.storage[9]=f*r[2]+g*r[6]+h*r[10]+i*r[14],this.storage[13]=f*r[3]+g*r[7]+h*r[11]+i*r[15],this.storage[2]=j*r[0]+k*r[4]+l*r[8]+m*r[12],this.storage[6]=j*r[1]+k*r[5]+l*r[9]+m*r[13],this.storage[10]=j*r[2]+k*r[6]+l*r[10]+m*r[14],this.storage[14]=j*r[3]+k*r[7]+l*r[11]+m*r[15],this.storage[3]=n*r[0]+o*r[4]+p*r[8]+q*r[12],this.storage[7]=n*r[1]+o*r[5]+p*r[9]+q*r[13],this.storage[11]=n*r[2]+o*r[6]+p*r[10]+q*r[14],this.storage[15]=n*r[3]+o*r[7]+p*r[11]+q*r[15],this},d.prototype.decompose=function(a,b,c){var e=f.zero(),g=e.setValues(this.storage[0],this.storage[1],this.storage[2]).length,h=e.setValues(this.storage[4],this.storage[5],this.storage[6]).length,i=e.setValues(this.storage[8],this.storage[9],this.storage[10]).length;this.determinant()<0&&(g=-g),a.storage[0]=this.storage[12],a.storage[1]=this.storage[13],a.storage[2]=this.storage[14];var j=1/g,k=1/h,l=1/i,m=d.copy(this);m.storage[0]*=j,m.storage[1]*=j,m.storage[2]*=j,m.storage[4]*=k,m.storage[5]*=k,m.storage[6]*=k,m.storage[8]*=l,m.storage[9]*=l,m.storage[10]*=l,b.setFromRotation(m.getRotation()),c.storage[0]=g,c.storage[1]=h,c.storage[2]=i},d.prototype.rotate3=function(a){var b=a.storage,c=this.storage[0]*b[0]+this.storage[4]*b[1]+this.storage[8]*b[2],d=this.storage[1]*b[0]+this.storage[5]*b[1]+this.storage[9]*b[2],e=this.storage[2]*b[0]+this.storage[6]*b[1]+this.storage[10]*b[2];return b[0]=c,b[1]=d,b[2]=e,a},d.prototype.rotated3=function(a){var b=f.copy(a);return this.rotate3(b)},d.prototype.transform3=function(a){var b=a.storage,c=this.storage[0]*b[0]+this.storage[4]*b[1]+this.storage[8]*b[2]+this.storage[12],d=this.storage[1]*b[0]+this.storage[5]*b[1]+this.storage[9]*b[2]+this.storage[13],e=this.storage[2]*b[0]+this.storage[6]*b[1]+this.storage[10]*b[2]+this.storage[14];return b[0]=c,b[1]=d,b[2]=e,a},d.prototype.transformed3=function(a){var b=f.copy(a);return this.transform3(b)},d.prototype.transform=function(a){var b=a.storage,c=this.storage[0]*b[0]+this.storage[4]*b[1]+this.storage[8]*b[2]+this.storage[12]*b[3],d=this.storage[1]*b[0]+this.storage[5]*b[1]+this.storage[9]*b[2]+this.storage[13]*b[3],e=this.storage[2]*b[0]+this.storage[6]*b[1]+this.storage[10]*b[2]+this.storage[14]*b[3],f=this.storage[3]*b[0]+this.storage[7]*b[1]+this.storage[11]*b[2]+this.storage[15]*b[3];return b[0]=c,b[1]=d,b[2]=e,b[3]=f,a},d.prototype.perspectiveTransform=function(a){var b=a.storage,c=this.storage[0]*b[0]+this.storage[4]*b[1]+this.storage[8]*b[2]+this.storage[12],d=this.storage[1]*b[0]+this.storage[5]*b[1]+this.storage[9]*b[2]+this.storage[13],e=this.storage[2]*b[0]+this.storage[6]*b[1]+this.storage[10]*b[2]+this.storage[14],f=1/(this.storage[3]*b[0]+this.storage[7]*b[1]+this.storage[11]*b[2]+this.storage[15]);return b[0]=c*f,b[1]=d*f,b[2]=e*f,a},d.prototype.transformed=function(a){var b=g.copy(a);return this.transform(b)},d.prototype.copyIntoArray=function(a,b){
var c=b;void 0===b&&(c=0),a[c+15]=this.storage[15],a[c+14]=this.storage[14],a[c+13]=this.storage[13],a[c+12]=this.storage[12],a[c+11]=this.storage[11],a[c+10]=this.storage[10],a[c+9]=this.storage[9],a[c+8]=this.storage[8],a[c+7]=this.storage[7],a[c+6]=this.storage[6],a[c+5]=this.storage[5],a[c+4]=this.storage[4],a[c+3]=this.storage[3],a[c+2]=this.storage[2],a[c+1]=this.storage[1],a[c+0]=this.storage[0]},d.prototype.copyFromArray=function(a,b){var c=b;void 0===b&&(c=0),this.storage[15]=a[c+15],this.storage[14]=a[c+14],this.storage[13]=a[c+13],this.storage[12]=a[c+12],this.storage[11]=a[c+11],this.storage[10]=a[c+10],this.storage[9]=a[c+9],this.storage[8]=a[c+8],this.storage[7]=a[c+7],this.storage[6]=a[c+6],this.storage[5]=a[c+5],this.storage[4]=a[c+4],this.storage[3]=a[c+3],this.storage[2]=a[c+2],this.storage[1]=a[c+1],this.storage[0]=a[c+0]}},{"./matrix3.js":4,"./quaternion.js":8,"./vector3.js":13,"./vector4.js":14}],6:[function(a,b,c){function d(){this.normal=e.zero(),this.constant=0}b.exports=d;var e=a("./vector3.js");d.intersection=function(a,b,c,d){var e=b.normal.cross(c.normal),f=-a.normal.dot(e),g=e.scaled(a.constant);e=c.normal.cross(a.normal);var h=e.scaled(b.constant);e=a.normal.cross(b.normal);var i=e.scaled(c.constant);d.x=(g.x+h.x+i.x)/f,d.y=(g.y+h.y+i.y)/f,d.z=(g.z+h.z+i.z)/f},d.copy=function(a){var b=new d;return b.constant=a.constant,b.normal.setFrom(a.normal),b},d.components=function(a,b,c,e){var f=new d;return f.setFromComponents(a,b,c,e),f},d.normalconstant=function(a,b){var c=new d;return c.normal.setFrom(a),c.constant=b,c},d.prototype.copyFrom=function(a){this.normal.setFrom(a.normal),this.constant=a.constant},d.prototype.setFromComponents=function(a,b,c,d){this.normal.setValues(a,b,c),this.constant=d},d.prototype.normalize=function(){var a=1/this.normal.length;this.normal.scale(a),this.constant=this.constant*a},d.prototype.distanceToVector3=function(a){return this.normal.dot(a)+this.constant}},{"./vector3.js":13}],7:[function(a,b,c){function d(){this.point0=e.zero(),this.point1=e.zero(),this.point2=e.zero(),this.point3=e.zero()}b.exports=d;var e=a("./vector3.js");a("./triangle.js");d.copy=function(a){var b=new d;return b.point0.setFrom(a.point0),b.point1.setFrom(a.point1),b.point2.setFrom(a.point2),b.point3.setFrom(a.point3),b},d.points=function(a,b,c,e){var f=new d;return f.point0.setFrom(a),f.point1.setFrom(b),f.point2.setFrom(c),f.point3.setFrom(e),f},d.prototype.copyFrom=function(a){this.point0.setFrom(a.point0),this.point1.setFrom(a.point1),this.point2.setFrom(a.point2),this.point3.setFrom(a.point3)},d.prototype.copyNormalInto=function(a){var b=this.point0.clone().sub(this.point1);a.setFrom(this.point2),a.sub(this.point1);var c=a.cross(b);c.normalize(),a.setFrom(c)},d.prototype.copyTriangles=function(a,b){a.point0.setFrom(this.point0),a.point1.setFrom(this.point1),a.point2.setFrom(this.point2),b.point0.setFrom(this.point0),b.point1.setFrom(this.point3),b.point2.setFrom(this.point2)},d.prototype.transform=function(a){a.transform3(this.point0),a.transform3(this.point1),a.transform3(this.point2),a.transform3(this.point3)},d.prototype.translate=function(a){this.point0.add(a),this.point1.add(a),this.point2.add(a),this.point3.add(a)}},{"./triangle.js":11,"./vector3.js":13}],8:[function(a,b,c){function d(a,b,c,d){this.storage=new Float32Array([a,b,c,d])}b.exports=d;var e=a("./matrix3.js"),f=a("./vector3.js");d.prototype.__defineGetter__("x",function(){return this.storage[0]}),d.prototype.__defineSetter__("x",function(a){this.storage[0]=a}),d.prototype.__defineGetter__("y",function(){return this.storage[1]}),d.prototype.__defineSetter__("y",function(a){this.storage[1]=a}),d.prototype.__defineGetter__("z",function(){return this.storage[2]}),d.prototype.__defineSetter__("z",function(a){this.storage[2]=a}),d.prototype.__defineGetter__("w",function(){return this.storage[3]}),d.prototype.__defineSetter__("w",function(a){this.storage[3]=a}),d.zero=function(){var a=new d(0,0,0,0);return a},d.fromRotation=function(a){var b=d.zero();return b.setFromRotation(a),b},d.axisAngle=function(a,b){var c=d.zero();return c.setAxisAngle(a,b),c},d.copy=function(a){var b=d.zero();return b.setFrom(a),b},d.random=function(){var a=d.zero();return a.setRandom(),a},d.identity=function(){var a=d.zero();return a.storage[3]=1,a},d.dq=function(a,b){var c=d.zero();return c.setDQ(c,b),c},d.euler=function(a,b,c){var e=d.zero();return e.setEuler(a,b,c),e},d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,4),c},d.prototype.clone=function(){return d.copy(this)},d.prototype.setFrom=function(a){var b=a.storage;this.storage[0]=b[0],this.storage[1]=b[1],this.storage[2]=b[2],this.storage[3]=b[3]},d.prototype.setValues=function(a,b,c,d){this.storage[0]=a,this.storage[1]=b,this.storage[2]=c,this.storage[3]=d},d.prototype.setAxisAngle=function(a,b){var c=a.length;if(0!=c){var d=Math.sin(.5*b)/c,e=a.storage;this.storage[0]=e[0]*d,this.storage[1]=e[1]*d,this.storage[2]=e[2]*d,this.storage[3]=Math.cos(.5*b)}},d.prototype.setFromRotation=function(a){var b=a.storage,c=a.trace(),d=Math.sqrt(c+1);if(c>0)this.storage[3]=.5*d,d=.5/d,this.storage[0]=(b[5]-b[7])*d,this.storage[1]=(b[6]-b[2])*d,this.storage[2]=(b[1]-b[3])*d;else{var e=b[0]<b[4]?b[4]<b[8]?2:1:b[0]<b[8]?2:0,f=(e+1)%3,g=(e+2)%3;d=Math.sqrt(b[a.index(e,e)]-b[a.index(f,f)]-b[a.index(g,g)]+1),this.storage[e]=.5*d,d=.5/d,this.storage[3]=(b[a.index(g,f)]-b[a.index(f,g)])*d,this.storage[f]=(b[a.index(f,e)]+b[a.index(e,f)])*d,this.storage[g]=(b[a.index(g,e)]+b[a.index(e,g)])*d}},d.prototype.setRandom=function(){var a=Math.random(),b=Math.sqrt(1-a),c=Math.sqrt(a),d=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),f=Math.cos(d),g=Math.sin(d),h=Math.cos(e),i=Math.sin(e);this.storage[0]=g*b,this.storage[1]=f*b,this.storage[2]=i*c,this.storage[3]=h*c},d.prototype.setDQ=function(a,b){var c=a.storage,d=b.storage,e=c[0],f=c[1],g=c[2],h=c[3],i=d[0],j=d[1],k=d[2],l=i*h+j*g-k*f,m=j*h+k*e-i*g,n=k*h+i*f-j*e,o=-i*e-j*f-k*g;this.storage[0]=.5*l,this.storage[1]=.5*m,this.storage[2]=.5*n,this.storage[3]=.5*o},d.prototype.setEuler=function(a,b,c){var d=.5*a,e=.5*b,f=.5*c,g=Math.cos(d),h=Math.sin(d),i=Math.cos(e),j=Math.sin(e),k=Math.cos(f),l=Math.sin(f);this.storage[0]=k*j*g+l*i*h,this.storage[1]=k*i*h-l*j*g,this.storage[2]=l*i*g-k*j*h,this.storage[3]=k*i*g+l*j*h},d.prototype.normalize=function(){var a=this.length;return 0==a?this:(a=1/a,this.storage[3]=this.storage[3]*a,this.storage[2]=this.storage[2]*a,this.storage[1]=this.storage[1]*a,this.storage[0]=this.storage[0]*a,this)},d.prototype.conjugate=function(){return this.storage[2]=-this.storage[2],this.storage[1]=-this.storage[1],this.storage[0]=-this.storage[0],this},d.prototype.inverse=function(){var a=1/this.length2;return this.storage[3]=this.storage[3]*a,this.storage[2]=-this.storage[2]*a,this.storage[1]=-this.storage[1]*a,this.storage[0]=-this.storage[0]*a,this},d.prototype.normalized=function(){var a=this.clone();return a.normalize(),a},d.prototype.conjugated=function(){var a=this.clone();return a.conjugate(),a},d.prototype.inverted=function(){var a=this.clone();return a.inverse(),a},d.prototype.__defineGetter__("radians",function(){return 2*Math.acos(this.storage[3])}),d.prototype.__defineGetter__("axis",function(){var a=1/(1-this.storage[3]*this.storage[3]);return new f(this.storage[0]*a,this.storage[1]*a,this.storage[2]*a)}),d.prototype.__defineGetter__("length2",function(){var a=this.storage[0],b=this.storage[1],c=this.storage[2],d=this.storage[3];return a*a+b*b+c*c+d*d}),d.prototype.__defineGetter__("length",function(){return Math.sqrt(this.length2)}),d.prototype.rotated=function(a){var b=a.clone();return this.rotate(b),b},d.prototype.rotate=function(a){var b=this.storage[3],c=this.storage[2],d=this.storage[1],e=this.storage[0],f=b,g=-c,h=-d,i=-e,j=f*a.x+0*i+h*a.z-g*a.y,k=f*a.y+0*h+g*a.x-i*a.z,l=f*a.z+0*g+i*a.y-h*a.x,m=0*f-i*a.x-h*a.y-g*a.z,n=m*e+j*b+k*c-l*d,o=m*d+k*b+l*e-j*c,p=m*c+l*b+j*d-k*e,q=a.storage;return q[2]=p,q[1]=o,q[0]=n,a},d.prototype.add=function(a){var b=a.storage;this.storage[0]=this.storage[0]+b[0],this.storage[1]=this.storage[1]+b[1],this.storage[2]=this.storage[2]+b[2],this.storage[3]=this.storage[3]+b[3]},d.prototype.sub=function(a){var b=a.storage;this.storage[0]=this.storage[0]-b[0],this.storage[1]=this.storage[1]-b[1],this.storage[2]=this.storage[2]-b[2],this.storage[3]=this.storage[3]-b[3]},d.prototype.scale=function(a){this.storage[3]=this.storage[3]*a,this.storage[2]=this.storage[2]*a,this.storage[1]=this.storage[1]*a,this.storage[0]=this.storage[0]*a},d.prototype.scaled=function(a){var b=this.clone();return b.scale(a),b},d.prototype.mult=function(a){var b=this.storage[3],c=this.storage[2],e=this.storage[1],f=this.storage[0],g=a.storage,h=g[3],i=g[2],j=g[1],k=g[0];return new d(b*k+f*h+e*i-c*j,b*j+e*h+c*k-f*i,b*i+c*h+f*j-e*k,b*h-f*k-e*j-c*i)},d.prototype.equals=function(a){return this.storage[0]==a.storage[0]&&this.storage[1]==a.storage[1]&&this.storage[2]==a.storage[2]&&this.storage[3]==a.storage[3]},d.prototype.almostEquals=function(a,b){return void 0===b&&(b=Number.EPSILON),Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b||Math.abs(this.z-a.z)>b||Math.abs(this.w-a.w)>b?!1:!0},d.prototype.added=function(a){var b=this.clone();return b.add(a),b},d.prototype.subbed=function(a){var b=this.clone();return b.sub(a),b},d.prototype.negated=function(){return this.conjugated()},d.prototype.getAt=function(a){return this.storage[a]},d.prototype.setAt=function(a,b){this.storage[a]=b},d.prototype.asRotationMatrix=function(){return this.copyRotationInto(e.zero())},d.prototype.copyRotationInto=function(a){var b=this.length2;if(0==b)return null;var c=2/b,d=this.storage[0],e=this.storage[1],f=this.storage[2],g=this.storage[3],h=d*c,i=e*c,j=f*c,k=g*h,l=g*i,m=g*j,n=d*h,o=d*i,p=d*j,q=e*i,r=e*j,s=f*j,t=a.storage;return t[0]=1-(q+s),t[1]=o+m,t[2]=p-l,t[3]=o-m,t[4]=1-(n+s),t[5]=r+k,t[6]=p+l,t[7]=r-k,t[8]=1-(n+q),a},d.prototype.toString=function(){return this.storage[0].toString()+", "+this.storage[1].toString()+", "+this.storage[2].toString()+", "+this.storage[3].toString()},d.prototype.relativeError=function(a){var b=a.subbed(this),c=b.length,d=a.length;return c/d},d.prototype.absoluteError=function(a){var b=this.length,c=a.length,d=Math.abs(b-c);return d}},{"./matrix3.js":4,"./vector3.js":13}],9:[function(a,b,c){function d(){this.origin=e.zero(),this.direction=e.zero()}b.exports=d;var e=a("./vector3.js");a("./aabb3.js");d.copy=function(a){var b=new d;return b.origin.setFrom(a.origin),b.direction.setFrom(a.direction),b},d.originDirection=function(a,b){var c=new d;return c.origin.setFrom(a),c.direction.setFrom(b),c},d.prototype.copyFrom=function(a){this.origin.setFrom(a.origin),this.direction.setFrom(a.direction)},d.prototype.at=function(a){var b=this.direction.scaled(a);return b.add(this.origin),b},d.prototype.copyAt=function(a,b){a.setFrom(this.direction),a.scale(b),a.add(this.origin)},d.prototype.intersectsWithSphere=function(a){var b=a.radius,c=b*b,d=a.center.clone();d.sub(this.origin);var e=d.dot(this.direction),f=d.dot(d);if(0>e&&f>c)return null;var g=f-e*e;if(g>c)return null;var h=Math.sqrt(c-g);return f>c?e-h:e+h};var f=e.zero(),g=e.zero(),h=e.zero(),i=e.zero(),j=e.zero();d.prototype.intersectsWithTriangle=function(a){var b=1e-5,c=a.point0,d=a.point1,e=a.point2;f.setFrom(d),f.sub(c),g.setFrom(e),g.sub(c),h=this.direction.cross(g);var k=f.dot(h);if(k>-b&&b>k)return null;var l=1/k;i.setFrom(this.origin),i.sub(c);var m=l*i.dot(h);if(0>m)return null;j=i.cross(f);var n=l*this.direction.dot(j);if(-b>n||m+n>1+b)return null;var o=l*g.dot(j);return o},d.prototype.intersectsWithQuad=function(a){var b=1e-5,c=a.point0,d=a.point1,e=a.point2;f.setFrom(d),f.sub(c),g.setFrom(e),g.sub(c),h=this.direction.crossInto(g);var k=f.dot(h);if(!(k>-b&&b>k)){var l=1/k;i.setFrom(this.origin),i.sub(c);var m=l*i.dot(h);if(m>=0){j=i.cross(f);var n=l*this.direction.dot(j);if(!(-b>n||m+n>1+b)){var o=l*g.dot(j);return o}}}c=a.point3,d=a.point0,e=a.point2,f.setFrom(d),f.sub(c),g.setFrom(e),g.sub(c),h=this.direction.cross(g);var p=f.dot(h);return p>-b&&b>p||(l=1/p,i.setFrom(this.origin),i.sub(c),m=l*i.dot(h),!(m>=0)||(j=i.cross(f),n=l*this.direction.dot(j),-b>n||m+n>1+b))?null:o=l*g.dot(j)},d.prototype.intersectsWithAabb3=function(a){for(var b=a.min,c=a.max,d=-Number.MAX_VALUE,e=Number.MAX_VALUE,f=0;3>f;++f)if(0==this.direction.storage[f]){if(this.origin.storage[f]<b.storage[f]||this.origin.storage[f]>c.storage[f])return null}else{var g=(b.storage[f]-this.origin.storage[f])/this.direction.storage[f],h=(c.storage[f]-this.origin.storage[f])/this.direction.storage[f];if(g>h){var i=g;g=h,h=i}if(g>d&&(d=g),e>h&&(e=h),d>e||0>e)return null}return d}},{"./aabb3.js":2,"./vector3.js":13}],10:[function(a,b,c){function d(){this.center=e.zero(),this.radius=0}b.exports=d;var e=a("./vector3.js");d.copy=function(a){var b=new d;return b.center.setFrom(a.center),b.radius=a.radius,b},d.centerRadius=function(a,b){var c=new d;return c.center.setFrom(a),c.radius=b,c},d.prototype.copyFrom=function(a){this.center.setFrom(a.center),this.radius=a.radius},d.prototype.containsVector3=function(a){return a.distanceToSquared(this.center)<this.radius*this.radius},d.prototype.intersectsWithVector3=function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},d.prototype.intersectsWithSphere=function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}},{"./vector3.js":13}],11:[function(a,b,c){function d(){this.point0=e.zero(),this.point1=e.zero(),this.point2=e.zero()}b.exports=d;var e=a("./vector3.js");d.copy=function(a){var b=new d;return b.point0.setFrom(a.point0),b.point1.setFrom(a.point1),b.point2.setFrom(a.point2),b},d.points=function(a,b,c){var e=new d;return e.point0.setFrom(a),e.point1.setFrom(b),e.point2.setFrom(c),e},d.prototype.copyFrom=function(a){this.point0.setFrom(a.point0),this.point1.setFrom(a.point1),this.point2.setFrom(a.point2)},d.prototype.copyNormalInto=function(a){var b=this.point0.clone().sub(this.point1);a.setFrom(this.point2),a.sub(this.point1);var c=a.cross(b);c.normalize(),a.setFrom(c)},d.prototype.transform=function(a){a.transform3(this.point0),a.transform3(this.point1),a.transform3(this.point2)},d.prototype.translate=function(a){this.point0.add(a),this.point1.add(a),this.point2.add(a)}},{"./vector3.js":13}],12:[function(a,b,c){function d(a,b){this.storage=new Float32Array([a,b])}b.exports=d,d.prototype.__defineGetter__("x",function(){return this.storage[0]}),d.prototype.__defineSetter__("x",function(a){this.storage[0]=a}),d.prototype.__defineGetter__("y",function(){return this.storage[1]}),d.prototype.__defineSetter__("y",function(a){this.storage[1]=a}),d.prototype.__defineGetter__("length",function(){return Math.sqrt(this.length2())}),d.prototype.__defineSetter__("length",function(a){if(0==a)this.setZero();else{if(l=this.length,0==l)return;l=a/l,this.storage[0]*=l,this.storage[1]*=l}}),d.zero=function(){var a=new d(0,0);return a},d.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this},d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,3),c.clone()},d.prototype.setValues=function(a,b){return this.storage[0]=a,this.storage[1]=b,this},d.copy=function(a){return new d(a.x,a.y)},d.all=function(a){var b=d.zero();return b.splat(a),b},d.min=function(a,b,c){c.x=Math.min(a.x,b.x),c.y=Math.min(a.y,b.y)},d.max=function(a,b,c){c.x=Math.max(a.x,b.x),c.y=Math.max(a.y,b.y)},d.mix=function(a,b,c,d){d.x=a.x+c*(b.x-a.x),d.y=a.y+c*(b.y-a.y)},d.prototype.clone=function(){return d.copy(this)},d.prototype.setFrom=function(a){return this.storage[0]=a.storage[0],this.storage[1]=a.storage[1],this},d.prototype.splat=function(a){return this.storage[0]=a,this.storage[1]=a,this},d.prototype.almostEquals=function(a,b){return void 0===b&&(b=Number.EPSILON),Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b?!1:!0},d.prototype.equals=function(a){return this.x==a.x&&this.y==a.y},d.prototype.almostZero=function(a){return void 0===a&&(a=Number.EPSILON),Math.abs(this.x)>a||Math.abs(this.y)>a?!1:!0},d.prototype.isZero=function(){return 0==this.x&&0==this.y},d.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this},d.prototype.sub=function(a){return this.storage[0]=this.storage[0]-a.storage[0],this.storage[1]=this.storage[1]-a.storage[1],this},d.prototype.add=function(a){return this.storage[0]=this.storage[0]+a.storage[0],this.storage[1]=this.storage[1]+a.storage[1],this},d.prototype.mul=function(a){return this.storage[0]=this.storage[0]*a.storage[0],this.storage[1]=this.storage[1]*a.storage[1],this},d.prototype.div=function(a){return this.storage[0]=this.storage[1]/a.storage[1],this.storage[1]=this.storage[1]/a.storage[1],this},d.prototype.scale=function(a){return this.storage[0]=this.storage[0]*a,this.storage[1]=this.storage[1]*a,this},d.prototype.scaled=function(a){var b=this.clone();return b.scale(a),b},d.prototype.reflect=function(a){var b=a.clone();return b.scale(2*a.dot(this)),this.sub(b),this},d.prototype.dot=function(a){return this.storage[0]*a.storage[0]+this.storage[1]*a.storage[1]},d.prototype.cross=function(a){return this.storage[0]*a.storage[1]-this.storage[1]*a.storage[0]},d.prototype.absolute=function(){this.storage[0]=Math.abs(this.storage[0]),this.storage[1]=Math.abs(this.storage[1])},d.prototype.clamp=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=Math.min(Math.max(this.storage[0],c[0]),d[0]),this.storage[1]=Math.min(Math.max(this.storage[1],c[1]),d[1]),this},d.prototype.clampScalar=function(a,b){return this.storage[0]=Math.min(Math.max(this.storage[0],a),b),this.storage[1]=Math.min(Math.max(this.storage[1],a),b),this},d.prototype.isNaN=function(){var a=!1;return a=a||this.storage[0].isNaN,a=a||this.storage[1].isNaN},d.prototype.isInfinite=function(){var a=!1;return a=a||this.storage[0].isInfinite(),a=a||this.storage[1].isInfinite()},d.prototype.toString=function(){return"[x="+this.storage[0]+", y="+this.storage[1]+"]"},d.prototype.length2=function(){return this.x*this.x+this.y*this.y},d.prototype.normalize=function(){var a=this.length;return 0!=a&&(a=1/a,this.storage[0]=this.x*a,this.storage[1]=this.y*a),this},d.prototype.normalized=function(){var a=this.clone();return a.normalize()},d.prototype.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},d.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},d.prototype.floor=function(){return this.storage[0]=Math.floor(this.x),this.storage[1]=Math.floor(this.y),this},d.prototype.ceil=function(){return this.storage[0]=Math.ceil(this.x),this.storage[1]=Math.ceil(this.y),this},d.prototype.round=function(){return this.storage[0]=Math.round(this.x),this.storage[1]=Math.round(this.y),this},d.prototype.roundToZero=function(){return this.storage[0]=this.storage[0]<0?Math.ceil(this.storage[0]):Math.floor(this.storage[0]),this.storage[1]=this.storage[1]<0?Math.ceil(this.storage[1]):Math.floor(this.storage[1]),this}},{}],13:[function(a,b,c){function d(a,b,c){this.storage=new Float32Array([a,b,c])}b.exports=d;a("./matrix3.js"),a("./matrix4.js");d.prototype.__defineGetter__("x",function(){return this.storage[0]}),d.prototype.__defineSetter__("x",function(a){this.storage[0]=a}),d.prototype.__defineGetter__("y",function(){return this.storage[1]}),d.prototype.__defineSetter__("y",function(a){this.storage[1]=a}),d.prototype.__defineGetter__("z",function(){return this.storage[2]}),d.prototype.__defineSetter__("z",function(a){this.storage[2]=a}),d.prototype.__defineGetter__("length",function(){return Math.sqrt(this.length2())}),d.prototype.__defineSetter__("length",function(a){if(0==a)this.setZero();else{if(l=this.length,0==l)return;l=a/l,this.storage[0]*=l,this.storage[1]*=l,this.storage[2]*=l}}),d.zero=function(){var a=new d(0,0,0);return a},d.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this},d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,3),c.clone()},d.prototype.setValues=function(a,b,c){return this.storage[0]=a,this.storage[1]=b,this.storage[2]=c,this},d.copy=function(a){return new d(a.x,a.y,a.z)},d.all=function(a){var b=d.zero();return b.splat(a),b},d.min=function(a,b,c){c.x=Math.min(a.x,b.x),c.y=Math.min(a.y,b.y),c.z=Math.min(a.z,b.z)},d.max=function(a,b,c){c.x=Math.max(a.x,b.x),c.y=Math.max(a.y,b.y),c.z=Math.max(a.z,b.z)},d.mix=function(a,b,c,d){d.x=a.x+c*(b.x-a.x),d.y=a.y+c*(b.y-a.y),d.z=a.z+c*(b.z-a.z)},d.prototype.clone=function(){return d.copy(this)},d.prototype.setFrom=function(a){return this.storage[0]=a.storage[0],this.storage[1]=a.storage[1],this.storage[2]=a.storage[2],this},d.prototype.splat=function(a){return this.storage[0]=a,this.storage[1]=a,this.storage[2]=a,this},d.prototype.almostEquals=function(a,b){return void 0===b&&(b=Number.EPSILON),Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b||Math.abs(this.z-a.z)>b?!1:!0},d.prototype.equals=function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z},d.prototype.almostZero=function(a){return void 0===a&&(a=Number.EPSILON),Math.abs(this.x)>a||Math.abs(this.y)>a||Math.abs(this.z)>a?!1:!0},d.prototype.isZero=function(){return 0==this.x&&0==this.y&&0==this.z},d.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this.storage[2]=-this.storage[2],this},d.prototype.sub=function(a){return this.storage[0]=this.storage[0]-a.storage[0],this.storage[1]=this.storage[1]-a.storage[1],this.storage[2]=this.storage[2]-a.storage[2],this},d.prototype.add=function(a){return this.storage[0]=this.storage[0]+a.storage[0],this.storage[1]=this.storage[1]+a.storage[1],this.storage[2]=this.storage[2]+a.storage[2],this},d.prototype.mul=function(a){return this.storage[0]=this.storage[0]*a.storage[0],this.storage[1]=this.storage[1]*a.storage[1],this.storage[2]=this.storage[2]*a.storage[2],this},d.prototype.div=function(a){return this.storage[0]=this.storage[1]/a.storage[1],this.storage[1]=this.storage[1]/a.storage[1],this.storage[2]=this.storage[2]/a.storage[2],this},d.prototype.scale=function(a){return this.storage[0]=this.storage[0]*a,this.storage[1]=this.storage[1]*a,this.storage[2]=this.storage[2]*a,this},d.prototype.scaled=function(a){var b=this.clone();return b.scale(a),b},d.prototype.reflect=function(a){var b=a.clone();return b.scale(2*a.dot(this)),this.sub(b),this},d.prototype.dot=function(a){return this.storage[0]*a.x+this.storage[1]*a.y+this.storage[2]*a.z},d.prototype.cross=function(a){var b=this.storage[1]*a.storage[2]-this.storage[2]*a.storage[1],c=this.storage[2]*a.storage[0]-this.storage[0]*a.storage[2],e=this.storage[0]*a.storage[1]-this.storage[1]*a.storage[0];return new d(b,c,e)},d.prototype.absolute=function(){this.storage[0]=Math.abs(this.storage[0]),this.storage[1]=Math.abs(this.storage[1]),this.storage[2]=Math.abs(this.storage[2])},d.prototype.postmultiply=function(a){var b=a.storage,c=this.storage[0],d=this.storage[1],e=this.storage[2];return this.storage[0]=c*b[0]+d*b[1]+e*b[2],this.storage[1]=c*b[3]+d*b[4]+e*b[5],this.storage[2]=c*b[6]+d*b[7]+e*b[8],this},d.prototype.applyProjection=function(a){var b=a.storage,c=this.storage[0],d=this.storage[1],e=this.storage[2],f=1/(b[3]*c+b[7]*d+b[11]*e+b[15]);return this.storage[0]=(b[0]*c+b[4]*d+b[8]*e+b[12])*f,this.storage[1]=(b[1]*c+b[5]*d+b[9]*e+b[13])*f,this.storage[2]=(b[2]*c+b[6]*d+b[10]*e+b[14])*f,this},d.prototype.applyAxisAngle=function(a,b){return this.applyQuaternion(Quaternion.axisAngle(a,b)),this},d.prototype.applyQuaternion=function(a){var b=a.storage,c=this.storage[0],d=this.storage[1],e=this.storage[2],f=b[0],g=b[1],h=b[2],i=b[3],j=i*c+g*e-h*d,k=i*d+h*c-f*e,l=i*e+f*d-g*c,m=-f*c-g*d-h*e;return this.storage[0]=j*i+m*-f+k*-h-l*-g,this.storage[1]=k*i+m*-g+l*-f-j*-h,this.storage[2]=l*i+m*-h+j*-g-k*-f,this},d.prototype.applyMatrix3=function(a){var b=a.storage,c=this.storage[0],d=this.storage[1],e=this.storage[2];return this.storage[0]=b[0]*c+b[3]*d+b[6]*e,this.storage[1]=b[1]*c+b[4]*d+b[7]*e,this.storage[2]=b[2]*c+b[5]*d+b[8]*e,this},d.prototype.applyMatrix4=function(a){var b=a.storage,c=this.storage[0],d=this.storage[1],e=this.storage[2];return this.storage[0]=b[0]*c+b[4]*d+b[8]*e+b[12],this.storage[1]=b[1]*c+b[5]*d+b[9]*e+b[13],this.storage[2]=b[2]*c+b[6]*d+b[10]*e+b[14],this},d.prototype.clamp=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=Math.min(Math.max(this.storage[0],c[0]),d[0]),this.storage[1]=Math.min(Math.max(this.storage[1],c[1]),d[1]),this.storage[2]=Math.min(Math.max(this.storage[2],c[2]),d[2]),this},d.prototype.clampScalar=function(a,b){return this.storage[0]=Math.min(Math.max(this.storage[0],a),b),this.storage[1]=Math.min(Math.max(this.storage[1],a),b),this.storage[2]=Math.min(Math.max(this.storage[2],a),b),this},d.prototype.isNaN=function(){var a=!1;return a=a||this.storage[0].isNaN,a=a||this.storage[1].isNaN,a=a||this.storage[2].isNaN},d.prototype.isInfinite=function(){var a=!1;return a=a||this.storage[0].isInfinite(),a=a||this.storage[1].isInfinite(),a=a||this.storage[2].isInfinite()},d.prototype.toString=function(){return"[x="+this.storage[0]+", y="+this.storage[1]+", z="+this.storage[2]+"]"},d.prototype.length2=function(){return this.storage[0]*this.storage[0]+this.storage[1]*this.storage[1]+this.storage[2]*this.storage[2]},d.prototype.normalize=function(){var a=this.length;return 0!=a&&(a=1/a,this.storage[0]*=a,this.storage[1]*=a,this.storage[2]*=a),this},d.prototype.normalized=function(){var a=this.clone();return a.normalize()},d.prototype.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},d.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},d.prototype.angleTo=function(a){var b=a.storage;if(this.storage[0]==b[0]&&this.storage[1]==b[1]&&this.storage[2]==b[2])return 0;var c=this.dot(a);return Math.acos(Math.min(Math.max(c,-1),1))},d.prototype.angleToSigned=function(a,b){var c=this.angleTo(a),d=this.cross(a),e=d.dot(b);return 0>e?-c:c},d.prototype.floor=function(){return this.storage[0]=Math.floor(this.x),this.storage[1]=Math.floor(this.y),this.storage[2]=Math.floor(this.z),this},d.prototype.ceil=function(){return this.storage[0]=Math.ceil(this.x),this.storage[1]=Math.ceil(this.y),this.storage[2]=Math.ceil(this.z),this},d.prototype.round=function(){return this.storage[0]=Math.round(this.x),this.storage[1]=Math.round(this.y),this.storage[2]=Math.round(this.z),this},d.prototype.roundToZero=function(){return this.storage[0]=this.storage[0]<0?Math.ceil(this.storage[0]):Math.floor(this.storage[0]),this.storage[1]=this.storage[1]<0?Math.ceil(this.storage[1]):Math.floor(this.storage[1]),this.storage[2]=this.storage[2]<0?Math.ceil(this.storage[2]):Math.floor(this.storage[2]),this}},{"./matrix3.js":4,"./matrix4.js":5}],14:[function(a,b,c){function d(a,b,c,d){this.storage=new Float32Array([a,b,c,d])}b.exports=d,d.prototype.__defineGetter__("x",function(){return this.storage[0]}),d.prototype.__defineSetter__("x",function(a){this.storage[0]=a}),d.prototype.__defineGetter__("y",function(){return this.storage[1]}),d.prototype.__defineSetter__("y",function(a){this.storage[1]=a}),d.prototype.__defineGetter__("z",function(){return this.storage[2]}),d.prototype.__defineSetter__("z",function(a){this.storage[2]=a}),d.prototype.__defineGetter__("w",function(){return this.storage[3]}),d.prototype.__defineSetter__("w",function(a){this.storage[3]=a}),d.prototype.__defineGetter__("length",function(){return Math.sqrt(this.length2())}),d.prototype.__defineSetter__("length",function(a){if(0==a)this.setZero();else{if(l=this.length,0==l)return;l=a/l,this.storage[0]*=l,this.storage[1]*=l,this.storage[2]*=l,this.storage[3]*=l}}),d.zero=function(){var a=new d(0,0,0,0);return a},d.prototype.setZero=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this.storage[3]=0,this},d.fromFloat32Array=function(a){var b=d.zero();return b.storage=a,b},d.fromBuffer=function(a,b){var c=d.zero();return c.storage=new Float32Array(a,b,4),c.clone()},d.prototype.setValues=function(a,b,c){return this.storage[0]=a,this.storage[1]=b,this.storage[2]=c,this.storage[3]=c,this},d.copy=function(a){return new d(a.x,a.y,a.z,a.w)},d.all=function(a){var b=d.zero();return b.splat(a),b},d.identity=function(){var a=d.zero();return a.setIdentity(),a},d.prototype.setIdentity=function(){return this.storage[0]=0,this.storage[1]=0,this.storage[2]=0,this.storage[3]=1,this},d.min=function(a,b,c){c.x=Math.min(a.x,b.x),c.y=Math.min(a.y,b.y),c.z=Math.min(a.z,b.z),c.w=Math.min(a.w,b.w)},d.max=function(a,b,c){c.x=Math.max(a.x,b.x),c.y=Math.max(a.y,b.y),c.z=Math.max(a.z,b.z),c.w=Math.max(a.w,b.w)},d.mix=function(a,b,c,d){d.x=a.x+c*(b.x-a.x),d.y=a.y+c*(b.y-a.y),d.z=a.z+c*(b.z-a.z),d.w=a.w+c*(b.w-a.w)},d.prototype.clone=function(){return d.copy(this)},d.prototype.setFrom=function(a){return this.storage[0]=a.storage[0],this.storage[1]=a.storage[1],this.storage[2]=a.storage[2],this.storage[3]=a.storage[3],this},d.prototype.splat=function(a){return this.storage[0]=a,this.storage[1]=a,this.storage[2]=a,this.storage[3]=a,this},d.prototype.almostEquals=function(a,b){return void 0===b&&(b=Number.EPSILON),Math.abs(this.x-a.x)>b||Math.abs(this.y-a.y)>b||Math.abs(this.z-a.z)>b||Math.abs(this.w-a.w)>b?!1:!0},d.prototype.equals=function(a){return this.x==a.x&&this.y==a.y&&this.z==a.z&&this.w==a.w},d.prototype.almostZero=function(a){return void 0===a&&(a=Number.EPSILON),Math.abs(this.x)>a||Math.abs(this.y)>a||Math.abs(this.z)>a||Math.abs(this.w)>a?!1:!0},d.prototype.isZero=function(){return 0==this.x&&0==this.y&&0==this.z&&0==this.w},d.prototype.negate=function(){return this.storage[0]=-this.storage[0],this.storage[1]=-this.storage[1],this.storage[2]=-this.storage[2],this.storage[3]=-this.storage[3],this},d.prototype.sub=function(a){return this.storage[0]=this.storage[0]-a.storage[0],this.storage[1]=this.storage[1]-a.storage[1],this.storage[2]=this.storage[2]-a.storage[2],this.storage[3]=this.storage[2]-a.storage[3],this},d.prototype.add=function(a){return this.storage[0]=this.storage[0]+a.storage[0],this.storage[1]=this.storage[1]+a.storage[1],this.storage[2]=this.storage[2]+a.storage[2],this.storage[3]=this.storage[3]+a.storage[3],this},d.prototype.mul=function(a){return this.storage[0]=this.storage[0]*a.storage[0],this.storage[1]=this.storage[1]*a.storage[1],this.storage[2]=this.storage[2]*a.storage[2],this.storage[3]=this.storage[3]*a.storage[3],this},d.prototype.div=function(a){return this.storage[0]=this.storage[1]/a.storage[1],this.storage[1]=this.storage[1]/a.storage[1],this.storage[2]=this.storage[2]/a.storage[2],this.storage[3]=this.storage[3]/a.storage[3],this},d.prototype.scale=function(a){return this.storage[0]=this.storage[0]*a,this.storage[1]=this.storage[1]*a,this.storage[2]=this.storage[2]*a,this.storage[3]=this.storage[3]*a,this},d.prototype.scaled=function(a){var b=this.clone();return b.scale(a),this},d.prototype.reflect=function(a){var b=a.clone();return b.scale(2*a.dot(this)),this.sub(b),this},d.prototype.dot=function(a){return this.storage[0]*a.x+this.storage[1]*a.y+this.storage[2]*a.z+this.storage[3]*a.w},d.prototype.absolute=function(){this.storage[0]=Math.abs(this.storage[0]),this.storage[1]=Math.abs(this.storage[1]),this.storage[2]=Math.abs(this.storage[2]),this.storage[3]=Math.abs(this.storage[3])},d.prototype.clamp=function(a,b){var c=a.storage,d=b.storage;return this.storage[0]=Math.min(Math.max(this.storage[0],c[0]),d[0]),this.storage[1]=Math.min(Math.max(this.storage[1],c[1]),d[1]),this.storage[2]=Math.min(Math.max(this.storage[2],c[2]),d[2]),this.storage[3]=Math.min(Math.max(this.storage[3],c[3]),d[3]),this},d.prototype.clampScalar=function(a,b){return this.storage[0]=Math.min(Math.max(this.storage[0],a),b),this.storage[1]=Math.min(Math.max(this.storage[1],a),b),this.storage[2]=Math.min(Math.max(this.storage[2],a),b),
this.storage[3]=Math.min(Math.max(this.storage[3],a),b),this},d.prototype.isNaN=function(){var a=!1;return a=a||this.storage[0].isNaN,a=a||this.storage[1].isNaN,a=a||this.storage[2].isNaN,a=a||this.storage[3].isNaN},d.prototype.isInfinite=function(){var a=!1;return a=a||this.storage[0].isInfinite(),a=a||this.storage[1].isInfinite(),a=a||this.storage[2].isInfinite(),a=a||this.storage[3].isInfinite()},d.prototype.toString=function(){return"[x="+this.storage[0]+", y="+this.storage[1]+", z="+this.storage[2]+", w= "+this.storage[3]+"]"},d.prototype.length2=function(){return this.storage[0]*this.storage[0]+this.storage[1]*this.storage[1]+this.storage[2]*this.storage[2]+this.storage[3]*this.storage[3]},d.prototype.normalize=function(){var a=this.length;return 0!=a&&(a=1/a,this.storage[0]*=a,this.storage[1]*=a,this.storage[2]*=a,this.storage[3]*=a),this},d.prototype.normalized=function(){var a=this.clone();return a.normalize()},d.prototype.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z,e=this.w-a.w;return b*b+c*c+d*d+e*e},d.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},d.prototype.angleTo=function(a){var b=a.storage;if(this.storage[0]==b[0]&&this.storage[1]==b[1]&&this.storage[2]==b[2]&&this.storage[3]==b[3])return 0;var c=this.dot(a);return Math.acos(Math.min(Math.max(c,-1),1))},d.prototype.angleToSigned=function(a,b){var c=this.angleTo(a),d=this.cross(a),e=d.dot(b);return 0>e?-c:c},d.prototype.floor=function(){return this.storage[0]=Math.floor(this.x),this.storage[1]=Math.floor(this.y),this.storage[2]=Math.floor(this.z),this.storage[3]=Math.floor(this.w),this},d.prototype.ceil=function(){return this.storage[0]=Math.ceil(this.x),this.storage[1]=Math.ceil(this.y),this.storage[2]=Math.ceil(this.z),this.storage[3]=Math.ceil(this.w),this},d.prototype.round=function(){return this.storage[0]=Math.round(this.x),this.storage[1]=Math.round(this.y),this.storage[2]=Math.round(this.z),this.storage[3]=Math.round(this.w),this},d.prototype.roundToZero=function(){return this.storage[0]=this.storage[0]<0?Math.ceil(this.storage[0]):Math.floor(this.storage[0]),this.storage[1]=this.storage[1]<0?Math.ceil(this.storage[1]):Math.floor(this.storage[1]),this.storage[2]=this.storage[2]<0?Math.ceil(this.storage[2]):Math.floor(this.storage[2]),this.storage[3]=this.storage[3]<0?Math.ceil(this.storage[3]):Math.floor(this.storage[3]),this}},{}],15:[function(a,b,c){b.exports={version:a("../package.json").version,Vector2:a("./vector2.js"),Vector3:a("./vector3.js"),Vector4:a("./vector4.js"),Matrix2:a("./matrix2.js"),Matrix3:a("./matrix3.js"),Matrix4:a("./matrix4.js"),Quaternion:a("./quaternion.js"),Plane:a("./plane.js"),Sphere:a("./sphere.js"),Ray:a("./ray.js"),Triangle:a("./triangle.js")}},{"../package.json":1,"./matrix2.js":3,"./matrix3.js":4,"./matrix4.js":5,"./plane.js":6,"./quaternion.js":8,"./ray.js":9,"./sphere.js":10,"./triangle.js":11,"./vector2.js":12,"./vector3.js":13,"./vector4.js":14}]},{},[15])(15)});